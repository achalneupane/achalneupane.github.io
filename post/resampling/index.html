<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.4.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Achal Neupane">

  
  
  
    
  
  <meta name="description" content="Statistics series">

  
  <link rel="alternate" hreflang="en-us" href="/achalneupane.github.io/post/resampling/">

  


  

  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

  

  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700|Roboto:400,400italic,700|Roboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/achalneupane.github.io/css/academic.min.c66516cf97186fe7fa872ca1f0e4401a.css">

  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-145752794-1', 'auto');
      
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="https://www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  

  <link rel="manifest" href="/achalneupane.github.io/index.webmanifest">
  <link rel="icon" type="image/png" href="/achalneupane.github.io/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/achalneupane.github.io/img/icon-192.png">

  <link rel="canonical" href="/achalneupane.github.io/post/resampling/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@achalneupane">
  <meta property="twitter:creator" content="@achalneupane">
  
  <meta property="og:site_name" content="Achal Neupane">
  <meta property="og:url" content="/achalneupane.github.io/post/resampling/">
  <meta property="og:title" content="Resampling | Achal Neupane">
  <meta property="og:description" content="Statistics series"><meta property="og:image" content="/achalneupane.github.io/img/icon-192.png">
  <meta property="twitter:image" content="/achalneupane.github.io/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-08-18T17:26:23-05:00">
    
    <meta property="article:modified_time" content="2019-08-18T17:26:23-05:00">
  

  


  





  <title>Resampling | Achal Neupane</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/achalneupane.github.io/">Achal Neupane</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/achalneupane.github.io/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/achalneupane.github.io/#impact"><span>Impact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/achalneupane.github.io/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/achalneupane.github.io/#contact"><span>Contact</span></a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article" itemscope itemtype="http://schema.org/Article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">Resampling</h1>

  

  
    



<meta content="2019-08-18 17:26:23 -0500 CDT" itemprop="datePublished">
<meta content="2019-08-18 17:26:23 -0500 CDT" itemprop="dateModified">

<div class="article-metadata">

  
  
  
  
  <div>
    



  <span itemprop="author name" itemtype="http://schema.org/Person"><a href="/achalneupane.github.io/authors/achal-neupane/"><strong>Achal Neupane</strong></a></span>

  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    <time>Aug 18, 2019</time>
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    10 min read
  </span>
  

  
  
  

  
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/achalneupane.github.io/post/resampling/&amp;text=Resampling" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/achalneupane.github.io/post/resampling/&amp;t=Resampling" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Resampling&amp;body=/achalneupane.github.io/post/resampling/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/achalneupane.github.io/post/resampling/&amp;title=Resampling" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Resampling%20/achalneupane.github.io/post/resampling/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/achalneupane.github.io/post/resampling/&amp;title=Resampling" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>


  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      


<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<div id="instructions" class="section level1">
<h1>Instructions</h1>
<p>There are four exercises below. All are optional. You may solve these, one solution per exercise, and submit them for extra credit. You use R, SAS or Python as you wish.</p>
</div>
<div id="exercise-1." class="section level1">
<h1>Exercise 1.</h1>
<p>Consider the Hidalgo data set from Homework 9. Load the data, and calculate mean and median.</p>
<pre class="r"><code>hidalgo.dat = read.table(&quot;https://raw.githubusercontent.com/achalneupane/data/master/hidalgo.dat&quot;,
                         header = T,
                         sep = &quot;,&quot;
)

mean.hidalgo &lt;- mean(hidalgo.dat$X.060)
mean.hidalgo</code></pre>
<pre><code>## [1] 0.08607851</code></pre>
<pre class="r"><code>median.hidalgo &lt;- median(hidalgo.dat$X.060)
median.hidalgo</code></pre>
<pre><code>## [1] 0.08</code></pre>
<div id="part-a." class="section level3">
<h3>Part a.</h3>
<p>Calculate a jackknife estimate of the mean, and jackknife standard error of the mean, of these data. Are these values what you expect?</p>
<pre class="r"><code>y &lt;- hidalgo.dat$X.060
n &lt;- length(y)
hat.theta.rep &lt;- {}
for(i in 1:n){
  hat.theta.rep[i] = mean(y[-i])
}
bar.theta &lt;- mean(hat.theta.rep)
# jackknife estimate of the mean
bar.theta</code></pre>
<pre><code>## [1] 0.08607851</code></pre>
<pre class="r"><code>hat.theta &lt;- mean.hidalgo
# bias
print(bias.jack &lt;- (n-1) * (bar.theta - hat.theta))</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="r"><code>#jackknife standard error for mean would be 
jackknife.stderr.mean &lt;- sqrt((n-1) * mean((hat.theta.rep - mean(hat.theta.rep))^2))
jackknife.stderr.mean</code></pre>
<pre><code>## [1] 0.0006787497</code></pre>
<pre class="r"><code># which can also be calculated as:
variance.of.hat.theta.rep &lt;- var(hat.theta.rep)
jackknife.var = ((n-1)^2/n)*variance.of.hat.theta.rep
jackknife.stderr.mean = sqrt(jackknife.var)
jackknife.stderr.mean</code></pre>
<pre><code>## [1] 0.0006787497</code></pre>
<p>Yes, I think these values are what we should expect.</p>
</div>
<div id="part-b." class="section level3">
<h3>Part b.</h3>
<p>Calculate a jackknife estimate of the median, and jackknife standard error of the median, of these data. Are these values what you expect?</p>
<pre class="r"><code>print(hat.theta &lt;- median(y))</code></pre>
<pre><code>## [1] 0.08</code></pre>
<pre class="r"><code>  n &lt;- length(y)
  hat.theta.rep &lt;- {}
  for(i in 1:n){
    hat.theta.rep[i] = median(y[-i])
  }
  bar.theta &lt;- mean(hat.theta.rep)
  bar.theta</code></pre>
<pre><code>## [1] 0.08</code></pre>
<pre class="r"><code>  hat.theta &lt;- median.hidalgo
  # bias
  print(bias.jack &lt;- (n-1) * (bar.theta - hat.theta))</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="r"><code>  #jackknife standard error for median would be 
  jackknife.stderr.median &lt;- sqrt((n-1) * mean((hat.theta.rep - mean(hat.theta.rep))^2))
  jackknife.stderr.median</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="r"><code>  # # Also can be calculated as
  # variance.of.ests &lt;- var(hat.theta.rep)
  # jackknife.var = ((n-1)^2/n)*variance.of.ests
  # jackknife.stderr = sqrt(jackknife.var)
  # jackknife.stderr
  
  # Or as:
  
  # n &lt;-length(y)
  # theta &lt;- median(y)
  # jk &lt;- sapply(1:n, function(i) median(y[-i]))
  # 
  # thetaBar &lt;- mean(jk)
  # thetaBar
  # biasEst &lt;- (n - 1) * (thetaBar - theta)
  # biasEst
  # seEst &lt;- sqrt((n - 1) * mean((jk - thetaBar) ^ 2))
  # seEst
  
  
  
  # # To check our answer, we can check with the bootstrap package
  # 
  # library(bootstrap)
  # out &lt;- jackknife(y, median)
  # out$jack.se
  # out$jack.bias</code></pre>
</div>
<div id="part-c." class="section level3">
<h3>Part c.</h3>
<p>Calculate a bootstrap estimate of the mean, and of the median, of the Hidalgo data. Use <span class="math inline">\(B = 1000\)</span> samples.</p>
<pre class="r"><code> B &lt;- 1000
  star.theta.rep &lt;- rep(0,B)
  star.theta &lt;- mean(y)
  for(i in 1:B) {
    star.theta.rep[i] &lt;- mean(sample(y,replace=TRUE))
  }
  # bootstrap estimate of the mean
  star.bar.theta &lt;- mean (star.theta.rep)
  star.bar.theta</code></pre>
<pre><code>## [1] 0.08608038</code></pre>
<pre class="r"><code>  # BS estimate of standard error for mean
  se.boot.mean &lt;- sd(star.theta.rep - mean(star.theta.rep))
  se.boot.mean</code></pre>
<pre><code>## [1] 0.0006995937</code></pre>
<pre class="r"><code>  bstraps &lt;- c()
  for (i in 1:1000) {
    bsample &lt;- sample(y, length(y), replace=T)
    bstraps &lt;- c(median(bsample), bstraps)}
  star.hat.theta &lt;- median(bstraps)
  
  # bootstrap estimate of median
  star.hat.theta</code></pre>
<pre><code>## [1] 0.08</code></pre>
<pre class="r"><code>  # BS estimate of standard error for mean
  se.boot.median &lt;- sd(star.theta.rep - median(star.theta.rep))
  se.boot.median</code></pre>
<pre><code>## [1] 0.0006995937</code></pre>
</div>
<div id="part-d." class="section level3">
<h3>Part d.</h3>
<p>When data are normally distributed, and for large samples, the standard error of the median can be approximated by
<span class="math display">\[
s.e._{med} = 1.253 \times s.e._{mean}
\]</span>
where <span class="math inline">\(s.e._{mean} = \sigma /\sqrt{n}\)</span>.</p>
<p>How do the jackknife and bootstrap estimates of standard error compare to the parametric estimates?</p>
<pre class="r"><code>std &lt;- function(x) sd(x)/sqrt(length(x))
s.e.mean &lt;- std(hidalgo.dat$X.060)
s.e.mean</code></pre>
<pre><code>## [1] 0.0006787497</code></pre>
<pre class="r"><code>s.e.median &lt;- s.e.mean * 1.253
s.e.median</code></pre>
<pre><code>## [1] 0.0008504733</code></pre>
<pre class="r"><code># compared to 
jackknife.stderr.mean</code></pre>
<pre><code>## [1] 0.0006787497</code></pre>
<pre class="r"><code>jackknife.stderr.median</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="r"><code>se.boot.mean</code></pre>
<pre><code>## [1] 0.0006995937</code></pre>
<pre class="r"><code>se.boot.median</code></pre>
<pre><code>## [1] 0.0006995937</code></pre>
</div>
</div>
<div id="exercise-2." class="section level1">
<h1>Exercise 2.</h1>
<p>Consider the data from Homework 6.</p>
<pre class="r"><code>NATR332.DAT &lt;- data.frame(
  Y1 = c(146,141,135,142,140,143,138,137,142,136),
  Y2 = c(141,143,139,139,140,141,138,140,142,138)
)</code></pre>
<p>Let <span class="math inline">\(\theta\)</span> be the ratio of the two population means:</p>
<p><span class="math display">\[
\theta = \frac{\mu_{Y1}}{\mu_{Y2}}
\]</span>
Calculate jackknife and bootstrap estimates for <span class="math inline">\(\widehat{\theta}\)</span>, and for the standard error for <span class="math inline">\(\widehat{\theta}\)</span>.</p>
<div id="part-a.-jacknife." class="section level3">
<h3>Part a. Jacknife.</h3>
<pre class="r"><code>  n &lt;- nrow(NATR332.DAT)
  y &lt;- NATR332.DAT$Y1
  z &lt;- NATR332.DAT$Y2
  theta.hat &lt;- mean(y)/ mean(z)
  
  # computing jackknife replicates leaving one-out estimates
  theta.jack &lt;- numeric(n)
  
  for( i in 1:n){
    theta.jack[i] &lt;- mean(y[-i])/mean(z[-1])
  }
  bias &lt;- (n-1) * (mean(theta.jack)- theta.hat)
  bias</code></pre>
<pre><code>## [1] 0.006423983</code></pre>
<pre class="r"><code>  # now, we calculate standard error for jackknife
  se.jack &lt;- sqrt((n-1) * mean((theta.jack - mean(theta.jack))^2))
  se.jack</code></pre>
<pre><code>## [1] 0.007824608</code></pre>
</div>
<div id="part-b.-bootstrap." class="section level3">
<h3>Part b. Bootstrap.</h3>
<pre class="r"><code># For Bootstrap
  
  # let
  B = 1000
  theta.b &lt;- numeric(B)
  theta.hat &lt;- mean(NATR332.DAT$Y1)/mean(NATR332.DAT$Y2)
  
  n &lt;- nrow(NATR332.DAT)
  
  for(b in 1:B){
    i &lt;- sample (1:n, size = n, replace = TRUE)
    y &lt;- NATR332.DAT$Y1[i]
    z &lt;- NATR332.DAT$Y2[i]
    theta.b[b] &lt;- mean(y)/mean(z)
  }
  
  bias &lt;- mean(theta.b) - theta.hat
  se.boot &lt;- sd(theta.b)
  
  print(list(est = theta.hat, bias = bias, cv  = bias/se.boot, standard_error_bootstrap = se.boot))</code></pre>
<pre><code>## $est
## [1] 0.9992862
## 
## $bias
## [1] -3.979976e-05
## 
## $cv
## [1] -0.00663203
## 
## $standard_error_bootstrap
## [1] 0.006001143</code></pre>
</div>
</div>
<div id="exercise-3" class="section level1">
<h1>Exercise 3</h1>
<div id="part-a.-1" class="section level3">
<h3>Part a.</h3>
<p>Consider the ELO data. Subset the data to exclude non-qualifiers - <code>NQ</code> - then create a factor <code>AA</code>. This will indicate if the wrestler that as All-American (top 8 places), or did not place in the tournament. Use <code>ActualFinish</code> equals <code>AA</code>. Next, calculate an effect size <span class="math inline">\(d\)</span> for the difference in ELO scores between All-American and non-All-American wrestlers; you will need to calculate means and standard deviations as necessary. Since the populations are unbalanced, you will need to use a pooled sd of the form</p>
<p><span class="math display">\[
s_{pooled} = \sqrt{\frac{(n_1-1) s_1^2 + (n_2-1) s_2^2} {n_1 + n_2 -2}}
\]</span></p>
<pre class="r"><code>elo.dat &lt;- read.table(&quot;https://raw.githubusercontent.com/achalneupane/data/master/elo.csv&quot;, header = TRUE, row.names = 1, sep = &quot;,&quot;)
head(elo.dat)</code></pre>
<pre><code>##    Weight Conference     ELO ActualFinish ExpectedFinish
## 3     125        ACC 1380.84      cons 24     E[cons 16]
## 4     125        ACC 1404.51      cons 12     E[cons 12]
## 5     125        ACC 1348.79      cons 24     E[cons 24]
## 6     125     Big 12 1312.73      cons 32          E[NQ]
## 8     125     Big 12 1373.79      cons 24     E[cons 16]
## 12    125     Big 12 1398.16      cons 12          E[NQ]</code></pre>
<pre class="r"><code>elo.exNQ &lt;- elo.dat[!grepl(&quot;NQ&quot;, elo.dat$ExpectedFinish),]
# elo.exNQ$ActualFinish &lt;- as.factor(elo.exNQ$ActualFinish[grepl(&quot;AA&quot;, elo.exNQ$ActualFinish)])

# Creating a new column with AA and other
elo.exNQ$AA.Other &lt;- as.factor(ifelse(grepl(&#39;AA&#39;, elo.exNQ$ActualFinish), &#39;AA&#39;,
                            ifelse(!grepl(&#39;AA&#39;, elo.exNQ$ActualFinish), &#39;Other&#39;, NA)))

# # meand AA
# mean.dat &lt;- setNames(aggregate(elo.exNQ$ELO, list(elo.exNQ$AA.Other), mean), c(&quot;group&quot;, &quot;mean&quot;))
# sd.dat &lt;- setNames(aggregate(elo.exNQ$ELO, list(elo.exNQ$AA.Other), sd), c(&quot;group&quot;, &quot;SD&quot;))
# count.dat &lt;- setNames(aggregate(elo.exNQ$ELO, list(elo.exNQ$AA.Other), length), c(&quot;group&quot;, &quot;Count&quot;))

mean.dat &lt;- setNames(aggregate(elo.exNQ$ELO, list(elo.exNQ$ExpectedFinish), mean), c(&quot;group1&quot;, &quot;mean&quot;))
sd.dat &lt;- setNames(aggregate(elo.exNQ$ELO, list(elo.exNQ$ExpectedFinish), sd), c(&quot;group1&quot;, &quot;SD&quot;))
count.dat &lt;- setNames(aggregate(elo.exNQ$ELO, list(elo.exNQ$ExpectedFinish), length), c(&quot;group1&quot;, &quot;Count&quot;))



Mean_SD_Count.dat &lt;- Reduce(function(...)
  merge(..., by = c(&quot;group1&quot;), all.x = TRUE),
  lapply(
    list(mean.dat, sd.dat, count.dat),
    transform
    # grp = ave(seq_along(group), group, FUN = seq_along)
  ))

# Here as well, we will relabel our groups as &#39;AA&#39; and &#39;Other&#39;
Mean_SD_Count.dat$group &lt;- as.factor(ifelse(grepl(&#39;AA&#39;, Mean_SD_Count.dat$group1), &#39;AA&#39;,
                       ifelse(!grepl(&#39;AA&#39;, Mean_SD_Count.dat$group1), &#39;Other&#39;, NA)))

sd_pooled  &lt;- lapply( split(Mean_SD_Count.dat, Mean_SD_Count.dat$group),
                                  function(dd) sqrt( sum( dd$SD^2 * (dd$Count-1) )/(sum(dd$Count-1)-nrow(dd)) ) )
sd_pooled</code></pre>
<pre><code>## $AA
## [1] 41.31208
## 
## $Other
## [1] 16.58026</code></pre>
<pre class="r"><code># Now we get the mean of mean
Mean &lt;- lapply(split(Mean_SD_Count.dat, Mean_SD_Count.dat$group), function(dd) mean(dd$mean))

# Now  for Counts
Count &lt;- lapply(split(Mean_SD_Count.dat, Mean_SD_Count.dat$group), function(dd) sum(dd$Count))
# combine two lists as a dataframe
table.mean.sd &lt;- do.call(rbind, Map(data.frame, Mean = Mean, sd_pooled = sd_pooled, Count = Count))


cohen.d &lt;- function(m1, s1, m2, s2){
  cohens_d &lt;-(abs(m1-m2)/sqrt((s1^2+s2^2)/2))
  return(cohens_d)
}

required.replicates &lt;- function (m1, s1, m2, s2, alpha=0.05, beta=0.2){
  n &lt;- 2* ((((sqrt((s1^2 + s2^2)/2))/(m1-m2))^2) * (qnorm((1-alpha/2)) + qnorm((1-beta)))^2) 
  return(round(n,0))
}


effect_size &lt;- cohen.d(
  m1 = table.mean.sd$Mean[1],
  s1 = table.mean.sd$sd_pooled[1],
  m2 = table.mean.sd$Mean[2],
  s2 = table.mean.sd$sd_pooled[2]
)
effect_size</code></pre>
<pre><code>## [1] 2.687879</code></pre>
<pre class="r"><code>Req.Replicates &lt;- required.replicates(
  m1 = table.mean.sd$Mean[1],
  s1 = table.mean.sd$sd_pooled[1],
  m2 = table.mean.sd$Mean[2],
  s2 = table.mean.sd$sd_pooled[2]
)
Req.Replicates</code></pre>
<pre><code>## [1] 2</code></pre>
</div>
<div id="part-b.-1" class="section level3">
<h3>Part b.</h3>
<p>Calculate jackknife and bootstrap estimates of the error of <span class="math inline">\(d\)</span>. Since ELO is determined by a wrestlers success within a weight class, you will need to honor this grouping (or sampling) of the data. Calculate the jackknife by excluding one <code>Weight</code> at a time from the data, and recalculating <span class="math inline">\(d\)</span>; since there are 10 weight classes there should be 10 jackknife replicates.</p>
<p>For the bootstrap, sample from the 10 weight classes (use <code>unique</code> or <code>levels</code>). Note that you will not be able simply subset the data on something like <code>Weight %in% samples</code>, since the bootstrap will require duplicate samples. Instead, iterate over weight class samples and merge subsets of the original data.</p>
</div>
<div id="part-c.-1" class="section level3">
<h3>Part c.</h3>
<p>Compare your estimates of standard error to the parametric estimate, approximated by</p>
<p><span class="math display">\[
s.e._d ~ \sqrt{\frac{n_1 + n_2}{n_1 n_2} + \frac{d^2} {2(n_1 + n_2)}}
\]</span></p>
<pre class="r"><code>n1 = table.mean.sd$Count[1]
n2 = table.mean.sd$Count[2]
d = effect_size

# parametric estimate of standard error
s.e_d &lt;- sqrt((((n1 + n2)/(n1*n2))) + ((d^2)/(2*(n1+n2))))
s.e_d</code></pre>
<pre><code>## [1] 0.1778143</code></pre>
</div>
</div>
<div id="exercise-4" class="section level1">
<h1>Exercise 4</h1>
<p>Consider the data for U.S. Wholesale price for pumpkins 2018 in <code>pumpkins.csv</code>.</p>
<div id="part-a.-2" class="section level3">
<h3>Part a.</h3>
<p>Load the data, and calculate the <span class="math inline">\(F\)</span> test and the parametric <span class="math inline">\(P(&gt;F)\)</span> using the code below. (set <code>eval=TRUE</code>).</p>
<pre class="r"><code>pumpkins.dat &lt;- read.csv(&quot;https://raw.githubusercontent.com/achalneupane/data/master/pumpkins.csv&quot;, header = TRUE, sep = &quot;,&quot;)
attach(pumpkins.dat)
# print(summary(pumpkins.dat))</code></pre>
<pre class="r"><code>summary(aov(Price ~ Class, data=pumpkins.dat))</code></pre>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## Class        3  44687   14896   94.03 4.42e-14 ***
## Residuals   26   4119     158                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>tt &lt;- summary(aov(Price ~ Class, data = pumpkins.dat))
# p value
tt[[1]][[&quot;Pr(&gt;F)&quot;]][1]</code></pre>
<pre><code>## [1] 4.421291e-14</code></pre>
<pre class="r"><code># F test
tt[[1]][[&quot;F value&quot;]][1]</code></pre>
<pre><code>## [1] 94.03394</code></pre>
</div>
<div id="part-b.-2" class="section level3">
<h3>Part b.</h3>
<p>Permute <code>Price</code> over <code>Class</code> - that assume create a new data set on the assumption that <code>Class</code> has not influence on <code>Price</code>. Do this 1000 times, and calculate the <span class="math inline">\(F\)</span> ratio for each. Plot the distribution of <span class="math inline">\(F\)</span>, and calculate how many <span class="math inline">\(F\)</span> are greater than the <span class="math inline">\(F\)</span> from part a. How does this compare with the parametric estimate for <span class="math inline">\(P(&gt;F\)</span>? Do you need to increase the number of permutations?</p>
<p>Answer: I do not see any of the calculated F-statistics greater then the F-statistics calculated from part a. Perhaps I need to increase the number of permutations.</p>
<pre class="r"><code>B &lt;- 1000
perm.theta.rep &lt;- rep(0,B)
F_ratio &lt;- {}
for(i in 1:B) {
  y.s &lt;- sample(Price)
  gg &lt;- aov(y.s ~ Class)
  # summary(tt)[[1]][[&quot;Pr(&gt;F)&quot;]]
  F_ratio.tmp &lt;- summary(gg)[[1]][[&quot;F value&quot;]][1]
  F_ratio &lt;- c(F_ratio, F_ratio.tmp)
}

F_ratio[1:10]</code></pre>
<pre><code>##  [1] 2.1244133 2.0804274 0.2769392 2.3313564 1.5388445 0.2999365 0.7825215
##  [8] 2.4445278 0.7377934 0.2932752</code></pre>
<pre class="r"><code># Distribution of F-ratio
hist(F_ratio)</code></pre>
<p><img src="/achalneupane.github.io/post/Resampling_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code># how many $F$ are greater than the $F$ from part a
sum(F_ratio &gt; tt[[1]][[&quot;F value&quot;]][1])</code></pre>
<pre><code>## [1] 0</code></pre>
</div>
<div id="part-c.-2" class="section level3">
<h3>Part c.</h3>
<p>Repeat part b, but this time, honor the <code>Week</code> grouping. That is, permute <code>Price</code> over <code>Class</code> only within observations grouped by <code>Week</code>. Compare this to</p>
<pre class="r"><code>summary(aov(Price ~ Class + as.factor(Week), data=pumpkins.dat))</code></pre>
<pre><code>##                 Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## Class            3  44687   14896  76.833 3.75e-11 ***
## as.factor(Week)  6    241      40   0.207     0.97    
## Residuals       20   3877     194                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>B &lt;- 1000
perm.theta.rep &lt;- rep(0,B)
F_ratio &lt;- {}
for(i in 1:B) {
  y.s &lt;- sample(Price)
  gg &lt;- aov(y.s ~ Class + as.factor(Week))
  # summary(tt)[[1]][[&quot;Pr(&gt;F)&quot;]]
  F_ratio.tmp &lt;- summary(gg)[[1]][[&quot;F value&quot;]][1]
  F_ratio &lt;- c(F_ratio, F_ratio.tmp)
}

F_ratio[1:10]</code></pre>
<pre><code>##  [1] 3.44507977 0.94367828 0.94121551 0.83887293 0.03820642 0.04714557
##  [7] 1.65091690 0.38516132 0.03399200 2.36358890</code></pre>
<pre class="r"><code># Distribution of F-ratio
hist(F_ratio)</code></pre>
<p><img src="/achalneupane.github.io/post/Resampling_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<pre class="r"><code>tt &lt;- summary(aov(Price ~ Class + as.factor(Week), data = pumpkins.dat))
sum(F_ratio &gt; tt[[1]][[&quot;F value&quot;]][1])</code></pre>
<pre><code>## [1] 0</code></pre>
<p>Which are more appropriate for these data?</p>
<p>I think having more number of permutations help in getting better statistics for these data.</p>
<p>Comments:
Ex 3. For the bootstrap, something like</p>
<pre class="r"><code># weights &lt;- unique(elo.dat$Weight)
# for (i in 1:samples) {
# weight.samples &lt;- sample(weights,replace=TRUE)
# elo.sub &lt;- c()
# for(w in weight.samples) {
# elo.sub &lt;- elo.dat[(elo.dat$Weight == w),]
# }</code></pre>
<p>It is a harder exercise, because we need to respect the sampling method of the original data, and for these data, wrestlers are grouped by weight class, so we need to sample weight classes. Similarly, for Ex 4, we want to sample Price observations within Week groups, so</p>
<pre class="r"><code># weeks &lt;- unique(pumpkins.dat$Week)
# for(i in 1:10000) {
#   for(week in weeks) {
#     mask &lt;- pumpkins.dat$Week==week
#     pumpkins.dat$Price[mask] &lt;- sample(pumpkins.dat$Price[mask])
# }
#     pumpkins.dat$Price[mask] &lt;-sample(pumpkins.dat$Price[mask])
#   }</code></pre>
<p>Consider if Ex 4 had been executed as a randomized complete block design, with Week as block. You would have independently randomized and applied treatment (Class) to each experimental unit within the block. We need to do the same thing with the bootstrap.</p>
</div>
</div>

    </div>

    


    

<div class="article-tags">
  
  <a class="badge badge-light" href="/achalneupane.github.io/tags/r/">R</a>
  
  <a class="badge badge-light" href="/achalneupane.github.io/tags/statistics/">Statistics</a>
  
  <a class="badge badge-light" href="/achalneupane.github.io/tags/statistical_programming/">Statistical_programming</a>
  
</div>



    
      








  
  
    
  
  





  
  
  
  
  <div class="media author-card" itemscope itemtype="http://schema.org/Person">
    

    <div class="media-body">
      <h5 class="card-title" itemprop="name"><a href="/achalneupane.github.io/authors/achal-neupane/"></a></h5>
      
      
      <ul class="network-icon" aria-hidden="true">
        
      </ul>
    </div>
  </div>



      
      
      <div class="article-widget">
        <div class="hr-light"></div>
        <h3>Related</h3>
        <ul>
          
          <li><a href="/achalneupane.github.io/post/additional_graphs/">Additional graphs</a></li>
          
          <li><a href="/achalneupane.github.io/post/final_assignment/">Final assignment</a></li>
          
          <li><a href="/achalneupane.github.io/post/midterm_project/">Midterm data analysis</a></li>
          
          <li><a href="/achalneupane.github.io/post/processing_text/">Processing text</a></li>
          
          <li><a href="/achalneupane.github.io/post/data_manipulation/">Data manipulation</a></li>
          
        </ul>
      </div>
      
    

    

    


  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
      

      
      
    

    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/achalneupane.github.io/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/achalneupane.github.io/js/academic.min.16bbb3750feb7244c9bc409a5a4fe678.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/achalneupane.github.io/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/achalneupane.github.io/terms/">Terms</a>
        
  </p>
  

  <p class="powered-by">
    Â© 2019 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
