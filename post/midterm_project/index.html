<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.4.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Achal Neupane">

  
  
  
    
  
  <meta name="description" content="Statistics series">

  
  <link rel="alternate" hreflang="en-us" href="/achalneupane.github.io/post/midterm_project/">

  


  

  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

  

  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700|Roboto:400,400italic,700|Roboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/achalneupane.github.io/css/academic.min.3072054fc61fe865aa34bcb366de141d.css">

  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-145752794-1', 'auto');
      
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="https://www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  

  <link rel="manifest" href="/achalneupane.github.io/index.webmanifest">
  <link rel="icon" type="image/png" href="/achalneupane.github.io/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/achalneupane.github.io/img/icon-192.png">

  <link rel="canonical" href="/achalneupane.github.io/post/midterm_project/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@achalneupane">
  <meta property="twitter:creator" content="@achalneupane">
  
  <meta property="og:site_name" content="Achal Neupane">
  <meta property="og:url" content="/achalneupane.github.io/post/midterm_project/">
  <meta property="og:title" content="Midterm data analysis | Achal Neupane">
  <meta property="og:description" content="Statistics series"><meta property="og:image" content="/achalneupane.github.io/img/icon-192.png">
  <meta property="twitter:image" content="/achalneupane.github.io/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-06-21T17:26:23-05:00">
    
    <meta property="article:modified_time" content="2019-06-21T17:26:23-05:00">
  

  


  





  <title>Midterm data analysis | Achal Neupane</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/achalneupane.github.io/">Achal Neupane</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/achalneupane.github.io/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/achalneupane.github.io/#impact"><span>Impact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/achalneupane.github.io/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/achalneupane.github.io/#contact"><span>Contact</span></a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article" itemscope itemtype="http://schema.org/Article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">Midterm data analysis</h1>

  

  
    



<meta content="2019-06-21 17:26:23 -0500 CDT" itemprop="datePublished">
<meta content="2019-06-21 17:26:23 -0500 CDT" itemprop="dateModified">

<div class="article-metadata">

  
  
  
  
  <div>
    



  <span itemprop="author name" itemtype="http://schema.org/Person"><a href="/achalneupane.github.io/authors/achal-neupane/"><strong>Achal Neupane</strong></a></span>

  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    <time>Jun 21, 2019</time>
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    21 min read
  </span>
  

  
  
  

  
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/achalneupane.github.io/post/midterm_project/&amp;text=Midterm%20data%20analysis" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/achalneupane.github.io/post/midterm_project/&amp;t=Midterm%20data%20analysis" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Midterm%20data%20analysis&amp;body=/achalneupane.github.io/post/midterm_project/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/achalneupane.github.io/post/midterm_project/&amp;title=Midterm%20data%20analysis" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Midterm%20data%20analysis%20/achalneupane.github.io/post/midterm_project/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/achalneupane.github.io/post/midterm_project/&amp;title=Midterm%20data%20analysis" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>


  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      


<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<p>In this exercise, I will be analyzing four fields as a
statistical consultant. This data comes from four different farm fields and we try to investigate the effects of variable seeding rates in overall yeild.</p>
<p>The table summarizes data from four corn fields. The top row are target seeding rates, in seeds per acre, the bottom row are
corn yields in bushels per acre.
This table summarizes all four fields at the Control Rate interval of 1000 which was also reproduced below in my anaysis. More importantly, we are interested in exploring the EffectSize and Required Replicates for properly examining any statistical evidence for the yield and variable seeding rates relationships.</p>
<table>
<thead>
<tr class="header">
<th>Rate</th>
<th>23000</th>
<th>24000</th>
<th>25000</th>
<th>26000</th>
<th>27000</th>
<th>28000</th>
<th>29000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Yield</td>
<td>111.4216</td>
<td>155.0326</td>
<td>181.1176</td>
<td>227.5800</td>
<td>233.4623</td>
<td>242.1753</td>
<td>231.3890</td>
</tr>
</tbody>
</table>
<p>The algorithm to do this analysis is divided into several steps as described below:</p>
<ol style="list-style-type: decimal">
<li>I have used some external packages like ggplot2 to make the plots.</li>
<li>I have written several functions to analyze each individual field as well as merged field statistics that calculates cohens effect size, required replicates, and does ANOVA analysis on individual field as well as on merged data from all fields.</li>
<li>Function <code>calculate_field_mean_SD_and_get_RR_EffSize</code> also uses mean, sd, and counts from each field to calculate cohens d and Required replicates. It also uses pooled standard deviations and Mean (mean of Means) calculated from all four fields for different control Rates to calculate cohens d and required replicates of combined field data. I have tested this function on all four fields at ControlRate level of 500, 1000, 2000 and 3000 intervals, then based on the results (also merged the output of all four intervals to get the effectSize and Required Replicates compared), I have decided to choose 1000 intervals of ControlRates for further analysis for combined data from all four fields.</li>
<li>I have also shown ANOVA analysis followed by TUKEY HSD test to show which ControlRates of seeding have significant effect on Yield for each field and then for all fields (combined all four fields).</li>
<li>Lastly, I have plotted EffectSize Vs RequiredReplicates for each field and also for combined data from four fields.</li>
</ol>
<p>Here, we first install ond load some of the packages (“multcompView”, “ggplot2”, “scales”, “data.table”) I will be using for this exercise.</p>
<pre class="r"><code># First, install missing packages and load them
myPackages &lt;- c(&quot;multcompView&quot;, &quot;ggplot2&quot;, &quot;scales&quot;, &quot;data.table&quot;)
my.installed.packages&lt;- installed.packages()
available.packages &lt;- myPackages %in% my.installed.packages
if (sum(!available.packages) &gt; 0){
  install.packages(myPackages[!available.packages])
}
# Load all required packages 
lapply(myPackages, require, character.only = TRUE)</code></pre>
<pre><code>## Loading required package: multcompView</code></pre>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## Loading required package: scales</code></pre>
<pre><code>## Loading required package: data.table</code></pre>
<pre><code>## [[1]]
## [1] TRUE
## 
## [[2]]
## [1] TRUE
## 
## [[3]]
## [1] TRUE
## 
## [[4]]
## [1] TRUE</code></pre>
<p>We will first write and describe our function here. We will be using these function to manipulate our data, calculate Cohen’s d, required replicates and also do ANOVA and TukeyHSD paired test, then finally to plot our data.
We can calculate EffectSize and RequiredReplicates for these data using functions from previous homework <code>cohen.d</code> and
<code>required.replicates</code>. These two functions are then called within another function <code>calculate_field_mean_SD_and_get_RR_EffSize</code> that analyzes each individual field and also merged data from all four fields to calculate Effect Size, Required Replictaes and then plot the results.</p>
<pre class="r"><code>cohen.d &lt;- function(m1, s1, m2, s2){
  cohens_d &lt;-(abs(m1-m2)/sqrt((s1^2+s2^2)/2))
  return(cohens_d)
}

required.replicates &lt;- function (m1, s1, m2, s2, alpha=0.05, beta=0.2){
  n &lt;- 2* ((((sqrt((s1^2 + s2^2)/2))/(m1-m2))^2) * (qnorm((1-alpha/2)) + qnorm((1-beta)))^2) 
  return(round(n,0))
}</code></pre>
<p>We willl also perform ANOVA analysis with Tukey Test for paired comparision of mean for each field data as well as merged data at different ControlRate intervals. This function does Tukey HSD test and generates label for significant outcomes.</p>
<pre class="r"><code># Create function to get the labels for Tukey HSD:
generate_label_df &lt;- function(TUKEY, variable){
  
  # Extract labels and factor levels from Tukey post-hoc 
  Tukey.levels &lt;- TUKEY[[variable]][,4]
  Tukey.labels &lt;- data.frame(multcompLetters(Tukey.levels)[&#39;Letters&#39;])
  
  #I need to put the labels in the same order as in the boxplot :
  Tukey.labels$treatment=rownames(Tukey.labels)
  Tukey.labels=Tukey.labels[order(Tukey.labels$treatment) , ]
  return(Tukey.labels)
}</code></pre>
<p>This function does ANOVA and makes boxplots with Tukey statistics for comparing Mean yield.</p>
<pre class="r"><code>get_my_box_plot &lt;- function (field, plot_name = &quot;the Field&quot;) {
  model = lm(field$Yield ~ field$ControlRate.Levels)
  ANOVA = aov(model)
  
  # Tukey test to study each pair of treatment :
  TUKEY &lt;- TukeyHSD(x = ANOVA, &#39;field$ControlRate.Levels&#39;, conf.level = 0.95)
  
  # generate labels using function
  labels &lt;- generate_label_df(TUKEY , &quot;field$ControlRate.Levels&quot;)
  
  # rename columns for merging
  names(labels) &lt;- c(&#39;Letters&#39;, &#39;ControlRate.Levels&#39;)
  
  # Obtain letter positions for y axis using means
  yvalue &lt;- aggregate(. ~ ControlRate.Levels, data = field, mean)
  
  final &lt;- merge(labels, yvalue) #merge dataframes
  
  p &lt;- ggplot(field, aes(x = ControlRate.Levels, y = Yield)) +
  geom_blank() +
  theme_bw() +
  theme(panel.grid.major = element_blank(),
  panel.grid.minor = element_blank()) +
  labs(x = &#39;Control Rates&#39;, y = &#39;Mean Yield&#39;) +
  ggtitle(paste0(&quot;ControlRates Vs Mean yield for &quot;, plot_name),
  expression(atop(italic(&quot;(Anova:TukeyHSD)&quot;), &quot;&quot;))) +
  theme(plot.title = element_text(hjust = 0.5, face = &#39;bold&#39;)) +
  geom_boxplot(fill = &#39;grey&#39;, stat = &quot;boxplot&quot;) +
  geom_text(
  data = final,
  aes(x = ControlRate.Levels, y = Yield, label = Letters),
  vjust = -3.5,
  hjust = -.5
  ) +
  geom_vline(aes(xintercept = 4.5), linetype = &quot;dashed&quot;) +
  theme(plot.title = element_text(vjust = -0.6))
  print(p)
  # print(TUKEY)
}</code></pre>
<p>Function to calculate mean and sd for each field for a given interval of
ControlRate and then calculate Required Replicates and EffectSize. I have made
one function to do all that so I can just use this function to analyze all
four fields. To analyze single field set <code>Single.Field.Analysis = TRUE</code>, and to analyze all four field together, set <code>Single.Field.Analysis = FALSE</code>,</p>
<pre class="r"><code>calculate_field_mean_SD_and_get_RR_EffSize &lt;- 
  function(
    field, intervals, Single.Field.Analysis = TRUE, printplot = FALSE){
  plot_NAME &lt;- (deparse(substitute(field)))
  if(Single.Field.Analysis &gt; 0){
  # removing rows with NAs in Yield
  sum(is.na(field$Yield))
  # field &lt;- field[!complete.cases(field$Yield), ]
  field &lt;- field[!is.na(field$Yield),]
  # as.factor(fieldA$ControlRate)
  table.field &lt;- table(as.factor(field$ControlRate))
  field$ControlRate.Levels &lt;- as.factor(intervals * ceiling(field$ControlRate/intervals))
  field.Count &lt;- setNames(aggregate(field$ControlRate, 
          by = list(field$ControlRate.Levels), FUN = length), c(&quot;ControlRate&quot;, &quot;Count&quot;))
  # Degree of freedome = n * k - k
  field.Count$degree.Freedom &lt;- 
    (field.Count$Count * length(field.Count$ControlRate)) -length(field.Count$ControlRate)
  
  field.mean &lt;-
    setNames(aggregate(
    field$Yield,
    by = list(field$ControlRate.Levels),
    FUN = mean
    ),
    c(&quot;ControlRate&quot;, &quot;Mean&quot;))
    
    field.SD &lt;-
    setNames(aggregate(
    field$Yield,
    by = list(field$ControlRate.Levels),
    FUN = sd
    ),
    c(&quot;ControlRate&quot;, &quot;SD&quot;))

  # plot individual fields with tukey test We will print box plot only if we
  # want for certain ControlRates intervals. Otherwise we will have too many
  # plots
  if(printplot == 1 ){
  get_my_box_plot(field, plot_name = plot_NAME)
  }
  # Else we work on the merged data with SD pooled; no need to calculate mean
  # and SD as we will be doing it below
  
  } else {
    temp.Field &lt;- field
    colnames(temp.Field)[colnames(temp.Field) == &quot;ControlRate&quot;] &lt;- &quot;ControlRate.Levels&quot;
    colnames(temp.Field)[colnames(temp.Field) == &quot;Mean&quot;] &lt;- &quot;Yield&quot;
    # get_my_box_plot(temp.Field)
    field.SD  &lt;- 
      as.data.frame(cbind(ControlRate = field[&quot;ControlRate&quot;], SD = field[&quot;SD_pooled&quot;]))
    field.mean &lt;- 
      as.data.frame(cbind(ControlRate = field[&quot;ControlRate&quot;], Mean = field[&quot;Mean&quot;]))
  }
  
# Calculate Required replicate and Effect Size from each
# field for ControlRate i vs i+1

# ReqRep_EffectSize_table &lt;- function (field.mean, field.SD){
Req.Rep.table.field &lt;- {}
for (i in 1:nrow(field.SD)){
  if(i+1 &gt; nrow(field.SD) ){
    break
  }
  temp.Effect.size &lt;-
    cohen.d(
    m1 = field.mean$Mean[i],
    s1 = field.SD$SD[i],
    m2 = field.mean$Mean[i + 1],
    s2 = field.SD$SD[i + 1]
    )
    
    tmp.req.reps &lt;-
    required.replicates(
    m1 = field.mean$Mean[i],
    s1 = field.SD$SD[i],
    m2 = field.mean$Mean[i + 1],
    s2 = field.SD$SD[i + 1]
    )
 
    tmp.table &lt;-
    cbind(
    Group = paste0(field.SD$ControlRate[i], &quot; Vs &quot;, field.SD$ControlRate[i +
    1]),
    EffectSize = temp.Effect.size,
    RequiredReplicates = tmp.req.reps
    )
      
      Req.Rep.table.field &lt;- rbind(Req.Rep.table.field, tmp.table)
}
if (Single.Field.Analysis &gt; 0) {
  return(
    list(
      field.mean = field.mean,
      fieldSD = field.SD,
      field.Count = field.Count,
      Req.Rep.table.field = Req.Rep.table.field
    )
  )
} else{
  return(list(Req.Rep.table.field = Req.Rep.table.field))
}
  }

###############################################End of Functions##########</code></pre>
<p>Now, we read four fields data:</p>
<pre class="r"><code>fieldA &lt;-
  read.table(
  &quot;https://raw.githubusercontent.com/achalneupane/data/master/fieldA.csv&quot;,
  header = TRUE,
  sep = &quot;,&quot;
  )
  # head(fieldA)
  dim(fieldA)</code></pre>
<pre><code>## [1] 6718    6</code></pre>
<pre class="r"><code>  tmp.fieldA &lt;- fieldA
  tmp.fieldA$ControlRate &lt;- as.factor(tmp.fieldA$ControlRate)
  # aggregate(fieldA$Yield, by = list(fieldA$ControlRate), FUN = mean)</code></pre>
<p>Note: There are 40 levels of Control rates in fieldA, we can reduce these levels, so what we can do is relevel them separated by ‘intervals’ of(say 1000) as used in ‘calculate_field_mean_SD’ function above. We can do the same for other fields. However, instead of checking all this one by one, we will be using the functions we described above to analyze these four fields data and get the plots.</p>
<pre class="r"><code>fieldB &lt;-
  read.table(
  &quot;https://raw.githubusercontent.com/achalneupane/data/master/fieldB.csv&quot;,
  header = TRUE,
  sep = &quot;,&quot;
  )
  # head(fieldB)
  dim(fieldB)</code></pre>
<pre><code>## [1] 9321    6</code></pre>
<pre class="r"><code>  # fieldC
  fieldC &lt;-
  read.table(
  &quot;https://raw.githubusercontent.com/achalneupane/data/master/fieldC.csv&quot;,
  header = TRUE,
  sep = &quot;,&quot;
  )
  # head(fieldC)
  dim(fieldC)</code></pre>
<pre><code>## [1] 10404     6</code></pre>
<pre class="r"><code>  # fieldD
  fieldD &lt;-
  read.table(
  &quot;https://raw.githubusercontent.com/achalneupane/data/master/fieldD.csv&quot;,
  header = TRUE,
  sep = &quot;,&quot;
  )
  # head(fieldD)
  dim(fieldD)</code></pre>
<pre><code>## [1] 12654     6</code></pre>
<p>we can calculate EffectSize and RequiredReplicates for these four fields using previous homeworks functions Cohen’s d and
required.replicates as described in the begining of this report.</p>
<p>Here, we can work on each individual field, first for the interval of 500, 1000,
2000 and 3000 ControlRates and decide which ControlRate interval fits the best
for our data. Then we we will work on merged data that we merge after
calculating individual fields (i.e using Mean and SD pooled for each
ControlRate from all fields)</p>
<p>We chan check how many replicates we need for each field if we compare at
the different ControlRates intervals starting with 500 to 3000. Set <code>eval = TRUE</code> to check this code.</p>
<p>At ControlRates interval of 500:</p>
<pre class="r"><code># Now we chan check how many replicates we need for each field if we compare at
# the different ControlRates intervals starting with 500 to 3000:

# At ControlRates interval of 500:
ControlRateInterval &lt;- 500

# field A
fieldA.data &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = fieldA, interval = ControlRateInterval
    )

# field B
fieldB.data &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = fieldB, interval = ControlRateInterval
    )

# field C
fieldC.data &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = fieldC, interval = ControlRateInterval
    )

# field D
fieldD.data &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = fieldD, interval = ControlRateInterval
    )

# Now, we merge all these so we can plot them together later
my_list &lt;- list(fieldA.data$Req.Rep.table.field, fieldB.data$Req.Rep.table.field, 
                fieldC.data$Req.Rep.table.field, fieldD.data$Req.Rep.table.field)

my_list_nms &lt;- setNames(my_list, c(&quot;fieldA&quot;, &quot;fieldB&quot;, &quot;fieldC&quot;, &quot;fieldD&quot;))
Merged.EffectSize.500 &lt;- 
  data.frame(rbindlist(lapply(my_list_nms, as.data.table), idcol = &quot;id&quot;))
Merged.EffectSize.500$interval &lt;- 500</code></pre>
<p>At ControlRates interval of 1000:</p>
<pre class="r"><code>ControlRateInterval &lt;- 1000

# field A
fieldA.data &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = fieldA, interval = ControlRateInterval
    )
# field B
fieldB.data &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = fieldB, interval = ControlRateInterval
    )

# field C
fieldC.data &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = fieldC, interval = ControlRateInterval
    )

# field D
fieldD.data &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = fieldD, interval = ControlRateInterval
    )

# Now, we merge all these so we can plot them together later
my_list &lt;- list(fieldA.data$Req.Rep.table.field, fieldB.data$Req.Rep.table.field, 
                fieldC.data$Req.Rep.table.field, fieldD.data$Req.Rep.table.field)

my_list_nms &lt;- setNames(my_list, c(&quot;fieldA&quot;, &quot;fieldB&quot;, &quot;fieldC&quot;, &quot;fieldD&quot;))
Merged.EffectSize.1000 &lt;- 
  data.frame(rbindlist(lapply(my_list_nms, as.data.table), idcol = &quot;id&quot;))

Merged.EffectSize.1000$interval &lt;- 1000</code></pre>
<p>At ControlRates interval of 2000:</p>
<pre class="r"><code>ControlRateInterval &lt;- 2000

# field A
fieldA.data &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = fieldA, interval = ControlRateInterval
    )
# field B
fieldB.data &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = fieldB, interval = ControlRateInterval
    )

# field C
fieldC.data &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = fieldC, interval = ControlRateInterval
    )

# field D
fieldD.data &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = fieldD, interval = ControlRateInterval
    )

# Now, we merge all these so we can plot them together later
my_list &lt;- list(fieldA.data$Req.Rep.table.field, fieldB.data$Req.Rep.table.field, 
                fieldC.data$Req.Rep.table.field, fieldD.data$Req.Rep.table.field)

my_list_nms &lt;- setNames(my_list, c(&quot;fieldA&quot;, &quot;fieldB&quot;, &quot;fieldC&quot;, &quot;fieldD&quot;))
Merged.EffectSize.2000 &lt;- 
  data.frame(rbindlist(lapply(my_list_nms, as.data.table), idcol = &quot;id&quot;))
Merged.EffectSize.2000$interval &lt;- 2000</code></pre>
<p>At ControlRates interval of 3000:</p>
<pre class="r"><code>ControlRateInterval &lt;- 3000

# field A
fieldA.data &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = fieldA, interval = ControlRateInterval
    )
# field B
fieldB.data &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = fieldB, interval = ControlRateInterval
    )

# field C
fieldC.data &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = fieldC, interval = ControlRateInterval
    )

# field D
fieldD.data &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = fieldD, interval = ControlRateInterval
    )

# Now, we merge all these so we can plot them together later
my_list &lt;- list(fieldA.data$Req.Rep.table.field, fieldB.data$Req.Rep.table.field, 
                fieldC.data$Req.Rep.table.field, fieldD.data$Req.Rep.table.field)

my_list_nms &lt;- setNames(my_list, c(&quot;fieldA&quot;, &quot;fieldB&quot;, &quot;fieldC&quot;, &quot;fieldD&quot;))
Merged.EffectSize.3000 &lt;- 
  data.frame(rbindlist(lapply(my_list_nms, as.data.table), idcol = &quot;id&quot;))
Merged.EffectSize.3000$interval &lt;- 3000</code></pre>
<p>Now, let’s plot these data for EffectSize Vs RequiredReplicates for each Field and fordifferent ControlRate intervals</p>
<pre class="r"><code>EffectSize.Plot &lt;-
  rbind(
  Merged.EffectSize.500,
  Merged.EffectSize.1000,
  Merged.EffectSize.2000,
  Merged.EffectSize.3000
  )

EffectSize.Plot$id &lt;- factor(EffectSize.Plot$id)
EffectSize.Plot$interval &lt;- factor(EffectSize.Plot$interval)
EffectSize.Plot$Group &lt;- factor(EffectSize.Plot$Group)
EffectSize.Plot$EffectSize &lt;- as.numeric(EffectSize.Plot$EffectSize)
EffectSize.Plot$RequiredReplicates &lt;- as.numeric(EffectSize.Plot$RequiredReplicates)
head(EffectSize.Plot)</code></pre>
<pre><code>##       id          Group EffectSize RequiredReplicates interval
## 1 fieldA 23000 Vs 23500 1.03546848                 15      500
## 2 fieldA 23500 Vs 24000 0.73574477                 29      500
## 3 fieldA 24000 Vs 25000 1.48620683                  7      500
## 4 fieldA 25000 Vs 25500 0.41887785                 89      500
## 5 fieldA 25500 Vs 26000 1.10746983                 13      500
## 6 fieldA 26000 Vs 26500 0.07390218               2874      500</code></pre>
<pre class="r"><code>scaleFUN &lt;- function(x) sprintf(&quot;%.2f&quot;, x)

# To eliminate any outliers and noise, we can plot effect Size between 0-1 and
# Required Replicates upto 5000
EffectSize.Plot &lt;- EffectSize.Plot[EffectSize.Plot$RequiredReplicates&lt;= 5000,]
EffectSize.Plot &lt;- EffectSize.Plot[EffectSize.Plot$EffectSize&lt;= 1,]

EffectSize.Plot$Group &lt;- factor(EffectSize.Plot$Group)

ggplot(EffectSize.Plot, aes(x=EffectSize, y=RequiredReplicates)) + 
  ggtitle(&quot;Effect size Vs Required replicates for each field data&quot;) +
  geom_point(aes(shape = Group), size = 2)  + 
  scale_shape_manual(values=1:nlevels(EffectSize.Plot$Group)) +
  geom_line() + 
  scale_x_continuous(&quot;EffectSize&quot;, breaks=c(0,0.2,0.5,1), labels = scaleFUN) +
  theme_bw() +
  theme(axis.title = element_text(size=14,face=&quot;bold&quot;), axis.text = element_text(size=10), 
        plot.title = element_text(hjust = 0.5, face = &quot;bold&quot;)) +
  facet_wrap(~id)</code></pre>
<p><img src="/achalneupane.github.io/post/Midterm_project_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Based on the plot we just plotted above, RequiredReplicates inccrease significantly with decreasing Effect Size.</p>
<p>Additionally, after running all these <code>ControlRateInterval</code>, I noticed that the Required replicates decrease for the higher ControlRate intervals. The reason I did not include this in my report is because it gives lots of output. SO, if we consider taking the ControlRate intervals of only 1000 and get the field mean and field SD for each field as below.</p>
<p>Now, I will only limit my analysis for all fields (merged) for the Control Rates interval of 1000.</p>
<pre class="r"><code># If we consider taking the ControlRate intervals of 1000 and get the field mean and field
# SD for each field:

ControlRateInterval &lt;- 1000
# field A
fieldA.data &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = fieldA, intervals = ControlRateInterval, printplot = TRUE
    )</code></pre>
<p><img src="/achalneupane.github.io/post/Midterm_project_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre class="r"><code>fieldA.data</code></pre>
<pre><code>## $field.mean
##   ControlRate      Mean
## 1       23000  63.01258
## 2       24000 100.63078
## 3       25000 172.57527
## 4       26000 237.45902
## 5       27000 237.33206
## 6       28000 238.59221
## 7       29000 195.73072
## 
## $fieldSD
##   ControlRate       SD
## 1       23000 15.45740
## 2       24000 51.36069
## 3       25000 41.82109
## 4       26000 31.64908
## 5       27000 44.09390
## 6       28000 38.11963
## 7       29000 53.59605
## 
## $field.Count
##   ControlRate Count degree.Freedom
## 1       23000    24            161
## 2       24000    93            644
## 3       25000    44            301
## 4       26000  4381          30660
## 5       27000   786           5495
## 6       28000  1283           8974
## 7       29000    99            686
## 
## $Req.Rep.table.field
##      Group            EffectSize            RequiredReplicates
## [1,] &quot;23000 Vs 24000&quot; &quot;0.991869049115401&quot;   &quot;16&quot;              
## [2,] &quot;24000 Vs 25000&quot; &quot;1.53614606065372&quot;    &quot;7&quot;               
## [3,] &quot;25000 Vs 26000&quot; &quot;1.74957194606738&quot;    &quot;5&quot;               
## [4,] &quot;26000 Vs 27000&quot; &quot;0.00330802194919998&quot; &quot;1434501&quot;         
## [5,] &quot;27000 Vs 28000&quot; &quot;0.0305749319500618&quot;  &quot;16792&quot;           
## [6,] &quot;28000 Vs 29000&quot; &quot;0.921630680790716&quot;   &quot;18&quot;</code></pre>
<p>Based on the plot we can see that the Mean Yield is significant between 23000 vs all ControlRates , 24000 vs all Control Rates, 25000 Vs all Control rates. Yeild has no significant effect of Seeding from Control Rate between 26000 to 28000. Infact, it starts to decline significantly from 29000 Control Seedings.</p>
<pre class="r"><code># field B
fieldB.data &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = fieldB, interval = ControlRateInterval, printplot = TRUE
    )</code></pre>
<p><img src="/achalneupane.github.io/post/Midterm_project_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre class="r"><code>fieldB.data</code></pre>
<pre><code>## $field.mean
##   ControlRate     Mean
## 1       24000 125.8102
## 2       25000 180.9337
## 3       26000 215.8033
## 4       27000 229.8309
## 5       28000 240.5746
## 6       29000 238.9680
## 
## $fieldSD
##   ControlRate       SD
## 1       24000 33.51371
## 2       25000 33.36007
## 3       26000 28.10560
## 4       27000 19.11270
## 5       28000 14.00890
## 6       29000 14.26832
## 
## $field.Count
##   ControlRate Count degree.Freedom
## 1       24000    36            210
## 2       25000   390           2334
## 3       26000  2455          14724
## 4       27000   798           4782
## 5       28000  5173          31032
## 6       29000   469           2808
## 
## $Req.Rep.table.field
##      Group            EffectSize          RequiredReplicates
## [1,] &quot;24000 Vs 25000&quot; &quot;1.64857878536612&quot;  &quot;6&quot;               
## [2,] &quot;25000 Vs 26000&quot; &quot;1.13048091635421&quot;  &quot;12&quot;              
## [3,] &quot;26000 Vs 27000&quot; &quot;0.583669852812804&quot; &quot;46&quot;              
## [4,] &quot;27000 Vs 28000&quot; &quot;0.641176026096802&quot; &quot;38&quot;              
## [5,] &quot;28000 Vs 29000&quot; &quot;0.113628916568796&quot; &quot;1216&quot;</code></pre>
<p>Here, we see significant difference between all Control Rates of Seeding except between 28000 Vs 29000. The seeding rates of 28000 has the highest Mean yield here.</p>
<pre class="r"><code># field C
fieldC.data &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = fieldC, interval = ControlRateInterval, printplot = TRUE
    )</code></pre>
<p><img src="/achalneupane.github.io/post/Midterm_project_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code>fieldC.data</code></pre>
<pre><code>## $field.mean
##   ControlRate     Mean
## 1       23000 149.2422
## 2       24000 185.4175
## 3       25000 195.8427
## 4       26000 225.0309
## 5       27000 231.4881
## 6       28000 240.9121
## 
## $fieldSD
##   ControlRate        SD
## 1       23000 14.416699
## 2       24000 15.340123
## 3       25000 13.316623
## 4       26000 14.335465
## 5       27000 11.247829
## 6       28000  4.463365
## 
## $field.Count
##   ControlRate Count degree.Freedom
## 1       23000    28            162
## 2       24000   170           1014
## 3       25000    69            408
## 4       26000  5697          34176
## 5       27000  4419          26508
## 6       28000    21            120
## 
## $Req.Rep.table.field
##      Group            EffectSize          RequiredReplicates
## [1,] &quot;23000 Vs 24000&quot; &quot;2.43022553971697&quot;  &quot;3&quot;               
## [2,] &quot;24000 Vs 25000&quot; &quot;0.725780226926124&quot; &quot;30&quot;              
## [3,] &quot;25000 Vs 26000&quot; &quot;2.1096712954133&quot;   &quot;4&quot;               
## [4,] &quot;26000 Vs 27000&quot; &quot;0.501162120939759&quot; &quot;63&quot;              
## [5,] &quot;27000 Vs 28000&quot; &quot;1.10136177756912&quot;  &quot;13&quot;</code></pre>
<p>Here, all Control rates of seeding are significantly diffferent with the highest Mean yeild for 28000.</p>
<pre class="r"><code># field D
fieldD.data &lt;- calculate_field_mean_SD_and_get_RR_EffSize(
  field = fieldD, interval = ControlRateInterval, printplot = TRUE
  )</code></pre>
<p><img src="/achalneupane.github.io/post/Midterm_project_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre class="r"><code>fieldD.data</code></pre>
<pre><code>## $field.mean
##   ControlRate     Mean
## 1       23000 113.4783
## 2       24000 157.5754
## 3       25000 176.8111
## 4       26000 227.5933
## 5       27000 240.8722
## 6       28000 247.0608
## 7       29000 230.0359
## 
## $fieldSD
##   ControlRate       SD
## 1       23000 24.58440
## 2       24000 39.35167
## 3       25000 36.11914
## 4       26000 26.50089
## 5       27000 17.44482
## 6       28000 15.63857
## 7       29000 25.17324
## 
## $field.Count
##   ControlRate Count degree.Freedom
## 1       23000    50            343
## 2       24000   372           2597
## 3       25000   132            917
## 4       26000  8284          57981
## 5       27000  1167           8162
## 6       28000  2631          18410
## 7       29000    18            119
## 
## $Req.Rep.table.field
##      Group            EffectSize          RequiredReplicates
## [1,] &quot;23000 Vs 24000&quot; &quot;1.34402785417073&quot;  &quot;9&quot;               
## [2,] &quot;24000 Vs 25000&quot; &quot;0.50928632312699&quot;  &quot;61&quot;              
## [3,] &quot;25000 Vs 26000&quot; &quot;1.60311540536477&quot;  &quot;6&quot;               
## [4,] &quot;26000 Vs 27000&quot; &quot;0.591895252495428&quot; &quot;45&quot;              
## [5,] &quot;27000 Vs 28000&quot; &quot;0.373564449867553&quot; &quot;112&quot;             
## [6,] &quot;28000 Vs 29000&quot; &quot;0.812438594873596&quot; &quot;24&quot;</code></pre>
<p>Here, all Control Rates of seeding are significantly different except for 26000-28000 Vs 29000 with the highest Mean yield for 28000.</p>
<p>Also, to check if my calculation of Control rates and Yeild mean matches with
the table in instruction (with 1000 intervals), we can check this with the merged field data (
i.e. fieldA, fieldB, fieldC and fieldD) data. We should get the same Mean values in
the instruction table above.</p>
<pre class="r"><code>all.merged.raw.fields &lt;- rbind(fieldA, fieldB, fieldC, fieldD)

check.the.instruction.table &lt;-
calculate_field_mean_SD_and_get_RR_EffSize(
  field = all.merged.raw.fields, intervals = ControlRateInterval
  )

check.the.instruction.table$field.mean</code></pre>
<pre><code>##   ControlRate     Mean
## 1       23000 111.4216
## 2       24000 155.0326
## 3       25000 181.1176
## 4       26000 227.5779
## 5       27000 233.4717
## 6       28000 242.1698
## 7       29000 231.3890</code></pre>
<p>We can now merge all four fields for SD, means and ControlRate level counts.</p>
<pre class="r"><code>merged.SD.4.plots &lt;-
  Reduce(
  function(x, y)
  merge(x, y, all = TRUE),
  list(
  fieldA.data$fieldSD,
  fieldB.data$fieldSD,
  fieldC.data$fieldSD,
  fieldD.data$fieldSD
  )
  )
  
  
  merged.Mean.4.plots &lt;-
  Reduce(
  function(x, y)
  merge(x, y, all = TRUE),
  list(
  fieldA.data$field.mean,
  fieldB.data$field.mean,
  fieldC.data$field.mean,
  fieldD.data$field.mean
  )
  )
  
  
  merged.Count.4.plots &lt;-
  Reduce(
  function(x, y)
  merge(x, y, all = TRUE),
  list(
  fieldA.data$field.Count,
  fieldB.data$field.Count,
  fieldC.data$field.Count,
  fieldD.data$field.Count
  )
  )</code></pre>
<p>We need SD pooled for these levels so we can calculate Cohen’s d and Required
Replicates.</p>
<pre class="r"><code>levels(merged.SD.4.plots$ControlRate)</code></pre>
<pre><code>## [1] &quot;23000&quot; &quot;24000&quot; &quot;25000&quot; &quot;26000&quot; &quot;27000&quot; &quot;28000&quot; &quot;29000&quot;</code></pre>
<p>First, we merged all merged.SD.4.plots, merged.Mean.4.plots and merged.Count.4.plots from all fields.</p>
<pre class="r"><code># Therefore, now merging all three dataframes from all four plots for SD, Mean
# and counts by ControlRate column
Mean_SD_Count.dat &lt;- Reduce(function(...)
  merge(..., by = c(&quot;ControlRate&quot;, &quot;grp&quot;), all.x = TRUE),
  lapply(
    list(merged.Mean.4.plots, merged.SD.4.plots, merged.Count.4.plots),
    transform,
    grp = ave(seq_along(ControlRate), ControlRate, FUN = seq_along)
  ))

head(Mean_SD_Count.dat)</code></pre>
<pre><code>##   ControlRate grp      Mean       SD Count degree.Freedom
## 1       23000   1  63.01258 14.41670    24            161
## 2       23000   2 113.47830 15.45740    28            162
## 3       23000   3 149.24222 24.58440    50            343
## 4       24000   1 100.63078 15.34012    36            210
## 5       24000   2 125.81017 33.51371    93            644
## 6       24000   3 157.57538 39.35167   170           1014</code></pre>
<p>Now, we can also do Anova on the merged data <code>Mean_SD_Count.dat</code></p>
<pre class="r"><code>Mean_SD_Count_merged_for_all_four_plots &lt;- Mean_SD_Count.dat
Mean_SD_Count_merged_for_all_four_plots$Yield &lt;-
Mean_SD_Count_merged_for_all_four_plots$Mean
Mean_SD_Count_merged_for_all_four_plots$ControlRate.Levels &lt;-
Mean_SD_Count_merged_for_all_four_plots$ControlRate

get_my_box_plot(Mean_SD_Count_merged_for_all_four_plots, plot_name = &quot;all four fields&quot;)</code></pre>
<p><img src="/achalneupane.github.io/post/Midterm_project_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Based on this plot, from all fields, we can tell that, Control Rates of seeding of 23000-25000 has significantly less Mean yield as compared to 26000-29000. It looks like Control Rates of Seeding between 27000 and 28000 has the highest Mean yield.</p>
<p>We now calculate pooled SD for merged 4 plots <code>Mean_SD_Count.dat</code> to calculate Effect Size and Required Replicates for all fields (combined analysis) using pooled SD.</p>
<pre class="r"><code>pooled.dat &lt;- Mean_SD_Count.dat


# # Pooled sd can be calculated as: 
pooled.dat$df &lt;- pooled.dat$Count-1
# pooled SD is :
# pooledSD &lt;- sqrt( sum(pooled.dat$sd^2 * pooled.dat$df) / sum(pooled.dat$df) )


# We can calculate our SD pooled using this formula:
#  s_{pooled} = \sqrt{\frac{\sum_i (n_i-1)s_i^2}{N-k}}
# We will derrive this in steps as below:

pooled.dat$df &lt;- pooled.dat$Count-1
pooled.dat$sd.square &lt;- pooled.dat$SD^2 

pooled.dat$ss &lt;- pooled.dat$sd.square * pooled.dat$df


# We can use convenience function (aggregate) for splitting and calculating the necessary sums.
ds &lt;- aggregate(ss ~ ControlRate, data = pooled.dat, sum)

# Two different built in methods for split apply, we could use aggregate for
# both if we wanted. This calculates our degrees of freedom.
ds$df &lt;- tapply(pooled.dat$df, pooled.dat$ControlRate, sum) 
# divide ss by df and then we get sd square
ds$sd.square &lt;- ds$ss / ds$df
# Finally, we can get our sd pooled
ds$SD_pooled &lt;- sqrt(ds$sd.square)
ds</code></pre>
<pre><code>##   ControlRate          ss    df sd.square SD_pooled
## 1       23000    40846.73    99  412.5933  20.31239
## 2       24000  1351941.68   667 2026.8991  45.02110
## 3       25000   934566.13   631 1481.0874  38.48490
## 4       26000 16376572.57 20813  786.8434  28.05073
## 5       27000  9357584.58  7166 1305.8309  36.13628
## 6       28000  8410659.15  9104  923.8422  30.39477
## 7       29000  1409909.69   583 2418.3700  49.17693</code></pre>
<pre class="r"><code># However, we could also calculate our sd_pooled as below and get the same results :
sd_pooled &lt;- lapply( split(Mean_SD_Count.dat, Mean_SD_Count.dat$ControlRate),
         function(dd) sqrt( sum( dd$SD^2 * (dd$Count-1) )/(sum(dd$Count-1)-nrow(dd)) ) )</code></pre>
<p>Now, we calculate Mean (Mean of Means) from the merged table <code>Mean_SD_Count.dat</code>, so we can calculate Cohen’s d and RequiredReplicates for all four field combined.</p>
<pre class="r"><code>ds.Mean &lt;-
  setNames(aggregate(
  Mean_SD_Count.dat$Mean,
  by = list(Mean_SD_Count.dat$ControlRate),
  FUN = mean
  ),
  c(&quot;ControlRate&quot;, &quot;Mean&quot;))

ds &lt;- merge(ds, ds.Mean, by.x = &quot;ControlRate&quot;)
ds</code></pre>
<pre><code>##   ControlRate          ss    df sd.square SD_pooled     Mean
## 1       23000    40846.73    99  412.5933  20.31239 108.5777
## 2       24000  1351941.68   667 2026.8991  45.02110 142.3585
## 3       25000   934566.13   631 1481.0874  38.48490 181.5407
## 4       26000 16376572.57 20813  786.8434  28.05073 226.4716
## 5       27000  9357584.58  7166 1305.8309  36.13628 234.8808
## 6       28000  8410659.15  9104  923.8422  30.39477 241.7849
## 7       29000  1409909.69   583 2418.3700  49.17693 221.5782</code></pre>
<p>Now we calculate the Effect Size and Cohen’s D for the combined 4 plots using mean yield and sd pooled for different ControlRate</p>
<p>Now we calculate the Effect Size and Cohen’s D for the combined 4 plots using mean yield and sd pooled for different ControlRate usinf our function <code>calculate_field_mean_SD_and_get_RR_EffSize</code>.</p>
<pre class="r"><code>RequiredReplicates_for_all_fields &lt;- 
  calculate_field_mean_SD_and_get_RR_EffSize(
    field = ds, intervals = ControlRateInterval, Single.Field.Analysis = FALSE
    )

RequiredReplicates_for_all_fields</code></pre>
<pre><code>## $Req.Rep.table.field
##      Group            EffectSize          RequiredReplicates
## [1,] &quot;23000 Vs 24000&quot; &quot;0.967241180364881&quot; &quot;17&quot;              
## [2,] &quot;24000 Vs 25000&quot; &quot;0.935567380483301&quot; &quot;18&quot;              
## [3,] &quot;25000 Vs 26000&quot; &quot;1.33427570681431&quot;  &quot;9&quot;               
## [4,] &quot;26000 Vs 27000&quot; &quot;0.259967383137317&quot; &quot;232&quot;             
## [5,] &quot;27000 Vs 28000&quot; &quot;0.206777477800031&quot; &quot;367&quot;             
## [6,] &quot;28000 Vs 29000&quot; &quot;0.49430440628565&quot;  &quot;64&quot;</code></pre>
<p>We can plot this results for better visualization of pattern.</p>
<pre class="r"><code>RequiredReplicates_for_all_fields &lt;-
  as.data.frame(RequiredReplicates_for_all_fields$Req.Rep.table.field)
  
  RequiredReplicates_for_all_fields$Group &lt;-
  factor(RequiredReplicates_for_all_fields$Group)
  
  RequiredReplicates_for_all_fields$RequiredReplicates &lt;-
  as.numeric(as.character(RequiredReplicates_for_all_fields$RequiredReplicates))
  
  RequiredReplicates_for_all_fields$EffectSize &lt;-
  as.numeric(as.character(RequiredReplicates_for_all_fields$EffectSize))
  
  # Plot RequiredReplicates_for_all_fields
  ggplot(RequiredReplicates_for_all_fields,
  aes(x = EffectSize, y = RequiredReplicates)) +
  ggtitle(&quot;Effect size Vs Required replicates for all fields data \n(Combined Effect)&quot;) +
  geom_point(aes(shape = Group), size = 2)  +
  scale_shape_manual(values = 1:nlevels(EffectSize.Plot$Group)) +
  geom_line() +
  scale_x_continuous(&quot;EffectSize&quot;,
  breaks = c(
  0,
  0.2,
  0.5,
  1,
  max(RequiredReplicates_for_all_fields$EffectSize)
  ),
  labels = scaleFUN) +
  theme_bw() +
  theme(
  axis.title = element_text(size = 14, face = &quot;bold&quot;),
  axis.text = element_text(size = 10),
  plot.title = element_text(hjust = 0.5, face = &quot;bold&quot;)
  )</code></pre>
<p><img src="/achalneupane.github.io/post/Midterm_project_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>Based on the combined effect size (from all four fields), we can see that the Effect size is inversely proportional to Required Replicates. We also see that for the small effect of ~0.2, we need exponentially larger replicates, for medium effect (~0.5), we need about 80 replicates and for larger effect (more than 0.8), we only need about 20 or fewer replicates. Our analysis from all fields also indicates that we have highest mean yeild for controlRates of Seeding og 27000-29000.</p>
<p>Final discussion and suggestion:</p>
<p>Based on the results we saw above, if we take individual field (one at a time), we would need thousands of replicates for low effect size. However, for moderate and large effect size, the required replicates number signficantly decreases even if we use individual field data separately. On the other hand, when we combine all four fields, our required replictes decreases for all low, moderate and large effect sizes (Figure: Effect size Vs Required replicates for all fields data (Combined Effect)) as compared to individual fields (Figure: Effect size Vs Required replicates for each field data). I also found that the required replicates decreases for lower rates of seeding (control Rates of 23000 Vs 24000).
Based on these results, we can also conclude that the Required replicates is inversely proportional to the Effect size as seen in all four fields data and merged data.</p>
<p>Aditionally, the mean yield significantly increases when we increase the seeding rates at control rates of 26000 to 28000 for each individual field. This was also consistent for combined field data (Figure: ControlRates Vs Mean yield for all four fields). So, my final suggestion for this analysis is that we should used all four fields to calculate required replicates and effect size, though we could still use single field data separately to derrive the conclusion that higher seeding rates (~26000-28000) has higher mean yield which was consistent in all four fields. However, making use of all four fields data is recommended.</p>

    </div>

    


    

<div class="article-tags">
  
  <a class="badge badge-light" href="/achalneupane.github.io/tags/r/">R</a>
  
  <a class="badge badge-light" href="/achalneupane.github.io/tags/statistics/">Statistics</a>
  
  <a class="badge badge-light" href="/achalneupane.github.io/tags/statistical_programming/">Statistical_programming</a>
  
</div>



    
      








  
  
    
  
  





  
  
  
  
  <div class="media author-card" itemscope itemtype="http://schema.org/Person">
    

    <div class="media-body">
      <h5 class="card-title" itemprop="name"><a href="/achalneupane.github.io/authors/achal-neupane/"></a></h5>
      
      
      <ul class="network-icon" aria-hidden="true">
        
      </ul>
    </div>
  </div>



      
      
      <div class="article-widget">
        <div class="hr-light"></div>
        <h3>Related</h3>
        <ul>
          
          <li><a href="/achalneupane.github.io/post/processing_text/">Processing text</a></li>
          
          <li><a href="/achalneupane.github.io/post/data_manipulation/">Data manipulation</a></li>
          
          <li><a href="/achalneupane.github.io/post/data_tables/">Data tables</a></li>
          
          <li><a href="/achalneupane.github.io/post/control_structures/">Control Structures</a></li>
          
          <li><a href="/achalneupane.github.io/post/functions/">Functions</a></li>
          
        </ul>
      </div>
      
    

    

    


  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
      

      
      
    

    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/achalneupane.github.io/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/achalneupane.github.io/js/academic.min.16bbb3750feb7244c9bc409a5a4fe678.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/achalneupane.github.io/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/achalneupane.github.io/terms/">Terms</a>
        
  </p>
  

  <p class="powered-by">
    &copy; 2019 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
