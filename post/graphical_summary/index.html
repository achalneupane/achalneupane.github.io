<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.4.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Achal Neupane">

  
  
  
    
  
  <meta name="description" content="Statistics series">

  
  <link rel="alternate" hreflang="en-us" href="/achalneupane.github.io/post/graphical_summary/">

  


  

  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

  

  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700|Roboto:400,400italic,700|Roboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/achalneupane.github.io/css/academic.min.3072054fc61fe865aa34bcb366de141d.css">

  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-145752794-1', 'auto');
      
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="https://www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  

  <link rel="manifest" href="/achalneupane.github.io/index.webmanifest">
  <link rel="icon" type="image/png" href="/achalneupane.github.io/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/achalneupane.github.io/img/icon-192.png">

  <link rel="canonical" href="/achalneupane.github.io/post/graphical_summary/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@achalneupane">
  <meta property="twitter:creator" content="@achalneupane">
  
  <meta property="og:site_name" content="Achal Neupane">
  <meta property="og:url" content="/achalneupane.github.io/post/graphical_summary/">
  <meta property="og:title" content="Graphical Summary | Achal Neupane">
  <meta property="og:description" content="Statistics series"><meta property="og:image" content="/achalneupane.github.io/img/icon-192.png">
  <meta property="twitter:image" content="/achalneupane.github.io/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-10-01T17:26:23-05:00">
    
    <meta property="article:modified_time" content="2019-10-01T17:26:23-05:00">
  

  


  





  <title>Graphical Summary | Achal Neupane</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/achalneupane.github.io/">Achal Neupane</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/achalneupane.github.io/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/achalneupane.github.io/#impact"><span>Impact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/achalneupane.github.io/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/achalneupane.github.io/#contact"><span>Contact</span></a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article" itemscope itemtype="http://schema.org/Article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">Graphical Summary</h1>

  

  
    



<meta content="2019-10-01 17:26:23 -0500 CDT" itemprop="datePublished">
<meta content="2019-10-01 17:26:23 -0500 CDT" itemprop="dateModified">

<div class="article-metadata">

  
  
  
  
  <div>
    



  <span itemprop="author name" itemtype="http://schema.org/Person"><a href="/achalneupane.github.io/authors/achal-neupane/"><strong>Achal Neupane</strong></a></span>

  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    <time>Oct 1, 2019</time>
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    11 min read
  </span>
  

  
  
  

  
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/achalneupane.github.io/post/graphical_summary/&amp;text=Graphical%20Summary" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/achalneupane.github.io/post/graphical_summary/&amp;t=Graphical%20Summary" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Graphical%20Summary&amp;body=/achalneupane.github.io/post/graphical_summary/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/achalneupane.github.io/post/graphical_summary/&amp;title=Graphical%20Summary" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Graphical%20Summary%20/achalneupane.github.io/post/graphical_summary/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/achalneupane.github.io/post/graphical_summary/&amp;title=Graphical%20Summary" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>


  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      


<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<p>Answer all questions specified on the problem and include a discussion on how your results answered/addressed the question.</p>
<p>Submit your  file with the knitted  (or knitted Word Document saved as a PDF). If you are having trouble with .rmd, let us know and we will help you, but both the .rmd and the PDF are required.</p>
<p>This file can be used as a skeleton document for your code/write up. Please follow the instructions found under Content titled Format+STAT-701+HW. No code should be in your PDF write-up unless stated otherwise.</p>
<p>For any question asking for plots/graphs, please do as the question asks as well as do the same but using the respective commands in the GGPLOT2 library. (So if the question asks for one plot, your results should have two plots. One produced using the given R-function and one produced from the GGPLOT2 equivalent). This doesn’t apply to questions that don’t specifically ask for a plot, however I still would encourage you to produce both.</p>
<p>You do not need to include the above statements.</p>
<p>Please do the following problems from the text book R Handbook and stated.</p>
<ol style="list-style-type: decimal">
<li>Question 1.1, pg. 23 in Handbook </li>
</ol>
<p>Here, for this question, we assume that we have data available for the given countries and we will remove any NAs from the data.</p>
<pre class="r"><code>library(&#39;HSAUR3&#39;)</code></pre>
<pre><code>## Loading required package: tools</code></pre>
<pre class="r"><code>#subset the data for wanted contries only first
median.subset &lt;- subset(Forbes2000,country %in% c(&quot;United States&quot;,&quot;United Kingdom&quot;,&quot;France&quot;,&quot;Germany&quot;))
# library(&quot;plyr&quot;)
# ddply(median.subset,c(&quot;country&quot;),function(x){median(x$profits,na.rm=T)})
by.country &lt;- setNames(aggregate(median.subset$profits, by = list(median.subset$country), function(x){median(x,na.rm=T)}), c(&quot;country&quot;, &quot;median&quot;))
by.country</code></pre>
<pre><code>##          country median
## 1         France  0.190
## 2        Germany  0.230
## 3 United Kingdom  0.205
## 4  United States  0.240</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Question 1.2, pg. 23 in Handbook</li>
</ol>
<pre class="r"><code>Forbes2000[Forbes2000$country == &quot;Germany&quot; &amp; Forbes2000$profits &lt; 0,&quot;name&quot;]</code></pre>
<pre><code>##  [1] &quot;Allianz Worldwide&quot;       &quot;Deutsche Telekom&quot;       
##  [3] &quot;E.ON&quot;                    &quot;HVB-HypoVereinsbank&quot;    
##  [5] &quot;Commerzbank&quot;             &quot;Infineon Technologies&quot;  
##  [7] &quot;BHW Holding&quot;             &quot;Bankgesellschaft Berlin&quot;
##  [9] &quot;W&amp;W-Wustenrot&quot;           &quot;mg technologies&quot;        
## [11] &quot;Nurnberger Beteiligungs&quot; &quot;SPAR Handels&quot;           
## [13] &quot;Mobilcom&quot;</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Question 1.3, pg. 23 in Handbook</li>
</ol>
<pre class="r"><code>sort(table(Forbes2000[Forbes2000$country==&quot;Bermuda&quot;,&quot;category&quot;]),decreasing=T)</code></pre>
<pre><code>## 
##                        Insurance                    Conglomerates 
##                               10                                2 
##             Oil &amp; gas operations                          Banking 
##                                2                                1 
##                    Capital goods             Food drink &amp; tobacco 
##                                1                                1 
##                     Food markets                            Media 
##                                1                                1 
##              Software &amp; services              Aerospace &amp; defense 
##                                1                                0 
##     Business services &amp; supplies                        Chemicals 
##                                0                                0 
##                     Construction                Consumer durables 
##                                0                                0 
##           Diversified financials            Drugs &amp; biotechnology 
##                                0                                0 
## Health care equipment &amp; services     Hotels restaurants &amp; leisure 
##                                0                                0 
##    Household &amp; personal products                        Materials 
##                                0                                0 
##                        Retailing                   Semiconductors 
##                                0                                0 
##  Technology hardware &amp; equipment      Telecommunications services 
##                                0                                0 
##                Trading companies                   Transportation 
##                                0                                0 
##                        Utilities 
##                                0</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Question 1.4, pg. 23 in Handbook</li>
</ol>
<pre class="r"><code>Forbes2000.data &lt;- Forbes2000[order(Forbes2000$profits,decreasing=T),]
par(mfrow = c(1,1))
# Using base plot
plot(
    log(Forbes2000.data[1:50, &quot;assets&quot;]),
    log(Forbes2000.data[1:50, &quot;sales&quot;])
    ,
    ylab = &quot;sales (log scale)&quot;,
    xlab = &quot;assets (log scale)&quot;,
    main = &quot;Sales vs Assets: Log transformed&quot;
)
# we can add texts to data points
text(
    x = log(Forbes2000.data[1:50, &quot;assets&quot;]),
    y = log(Forbes2000.data[1:50, &quot;sales&quot;]),
    labels = abbreviate(Forbes2000.data$country[1:50]),
    col = &quot;black&quot;,
    font = 1,
    pos = 1
)

#Using ggplot
library(ggplot2)</code></pre>
<p><img src="/achalneupane.github.io/post/Graphical_summary_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>ggplot(Forbes2000.data[1:50, ], aes(x = log(assets), y = log(sales))) +
    geom_point(shape = 1, size = 2) +
    geom_text(aes(label = abbreviate(country)), hjust = 0, vjust = 0) +
    labs(title = &quot;Sales vs Assets: Log transformed&quot;, color = &quot;country&quot;)</code></pre>
<p><img src="/achalneupane.github.io/post/Graphical_summary_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<ol start="5" style="list-style-type: decimal">
<li>Question 1.5, pg. 23 in Handbook</li>
</ol>
<pre class="r"><code>library(plyr)
# selecting companies with profit more than 5 billion
Forbes2000.5billions.dat &lt;- Forbes2000[Forbes2000$profits &gt; 5 ,]
Forbes2000.5billions.dat &lt;- Forbes2000.5billions.dat[complete.cases(Forbes2000.5billions.dat), ]

setNames(ddply(Forbes2000.5billions.dat,c(&quot;country&quot;),function(x){c(nrow(x),mean(x$sales))}), c(&quot;Country&quot;, &quot;Company_counts&quot;, &quot;Avg_Sales&quot;))</code></pre>
<pre><code>##                       Country Company_counts Avg_Sales
## 1                       China              1   29.5300
## 2                      France              1  131.6400
## 3                     Germany              1  157.1300
## 4                       Japan              1  135.8200
## 5 Netherlands/ United Kingdom              1  133.5000
## 6                 South Korea              1   50.2200
## 7                 Switzerland              3   46.7600
## 8              United Kingdom              3  103.6867
## 9               United States             20   77.2835</code></pre>
<pre class="r"><code># #or we could also do:
# aggregate(Forbes2000.5billions.dat$sales, by = list(Forbes2000.5billions.dat$country), function(x){c(Company_counts = length(x), Avg_Sales = mean(x))})</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Question 2.1, pg. 39 in Handbook (see Chapter 6 of R Graphcis Cookbook for GGPlot)</li>
</ol>
<p>For this, we will first calculate total household expenses as below. Then calculate the itemized expenses (proportion).</p>
<pre class="r"><code>data(&quot;household&quot;, package = &quot;HSAUR3&quot;)

# total expenses
household$total&lt;-household$housing+household$food+household$goods+household$service
library(ggplot2)

ggplot(household, aes(x=gender, y=total))+geom_boxplot() +
  labs(title = &quot;Total expenses per gender&quot;) + 
  theme_classic()</code></pre>
<p><img src="/achalneupane.github.io/post/Graphical_summary_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code># base R version
boxplot(household$total ~ household$gender,
        xlab = &quot;Gender&quot;, ylab = &quot;total&quot;, main = &quot;Total household expenses by gender&quot;)</code></pre>
<p><img src="/achalneupane.github.io/post/Graphical_summary_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<pre class="r"><code># This indicates that males tend to have more expenses than females in total. 
#calculate proportions
household$housing&lt;-household$housing/household$total
household$service&lt;-household$service/household$total
household$goods&lt;-household$goods/household$total
household$food&lt;-household$food/household$total

#plot boxplots of proportions
a&lt;-ggplot(household, aes(x=gender, y=housing))+geom_boxplot() + labs(title = &quot;Housing expenses (in %) per gender&quot;) 
b&lt;-ggplot(household, aes(x=gender, y=service))+geom_boxplot() + labs(title = &quot;Service expenses (in %) per gender&quot;)
c&lt;-ggplot(household, aes(x=gender, y=goods))+geom_boxplot() + labs(title = &quot;Goods expenses (in %) per gender&quot;)
d&lt;-ggplot(household, aes(x=gender, y=food))+geom_boxplot() + labs(title = &quot;Food expenses (in %) per gender&quot;)

# combine all 4 gg objects
library(gridExtra)
grid.arrange(a,b,c,d, nrow=2, ncol=2)</code></pre>
<p><img src="/achalneupane.github.io/post/Graphical_summary_files/figure-html/unnamed-chunk-6-3.png" width="672" /></p>
<pre class="r"><code># base R version
par(mfrow=c(2,2))
boxplot(household$housing ~ household$gender,
        xlab = &quot;Gender&quot;, ylab = &quot;Housing expenses&quot;, main = &quot;Housing expenses (in %) by gender&quot;)
boxplot(household$service ~ household$gender,
        xlab = &quot;Gender&quot;, ylab = &quot;Service expenses&quot;, main = &quot;Service expenses (in %) by gender&quot;)
boxplot(household$goods ~ household$gender,
        xlab = &quot;Gender&quot;, ylab = &quot;Goods expenses&quot;, main = &quot;Goods expenses (in %) by gender&quot;)
boxplot(household$food ~ household$gender,
        xlab = &quot;Gender&quot;, ylab = &quot;food expenses&quot;, main = &quot;Food expenses (in %) by gender&quot;)</code></pre>
<p><img src="/achalneupane.github.io/post/Graphical_summary_files/figure-html/unnamed-chunk-6-4.png" width="672" /></p>
<pre class="r"><code># histogram of total expenditures by gender
ggplot(household, aes(x=total, fill=gender)) +
  geom_histogram(position=&quot;identity&quot;, alpha=0.4, binwidth = 1000) + 
  labs(title = &quot;Histogram of total expenditures by gender&quot; ) + 
  theme_classic()</code></pre>
<p><img src="/achalneupane.github.io/post/Graphical_summary_files/figure-html/unnamed-chunk-6-5.png" width="672" /></p>
<p>Based on these results, males tend to spend more money than females on Foods
and Services, where as females take the lead on Housing and Goods.</p>
<ol start="7" style="list-style-type: decimal">
<li>Question 2.3, pg. 41 in Handbook (see Chapter 6 of R Graphcis Cookbook for GGPlot)</li>
</ol>
<pre class="r"><code>data(&quot;suicides2&quot;)
#Boxplot of mortality
boxplot(suicides2,
        xlab = &quot;Age group&quot;, ylab = &quot;Mortality rates per 100,000&quot;, main = &quot;Mortality by suicide&quot;)</code></pre>
<p><img src="/achalneupane.github.io/post/Graphical_summary_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>library(reshape2)
suicides2.melted &lt;- melt(suicides2)</code></pre>
<pre><code>## No id variables; using all as measure variables</code></pre>
<pre class="r"><code># ggplot version
ggplot(suicides2.melted, aes(x=factor(variable), y=value)) + 
  geom_boxplot() +
  labs(x = &quot;Age group&quot;, y = &quot;Mortality rates per 100,000&quot;, title = &quot;Mortality by suicide&quot;)</code></pre>
<p><img src="/achalneupane.github.io/post/Graphical_summary_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
<ol start="8" style="list-style-type: decimal">
<li>Using a single R expression, calculate the median absolute deviation, <span class="math inline">\(1.4826\cdot median|x-\mu|\)</span>, where <span class="math inline">\(\mu\)</span> is the sample median. Use the dataset . Use the R function mad() to verify your answer.</li>
</ol>
<pre class="r"><code>median(abs(chickwts$weight - median(chickwts$weight))) * 1.4826</code></pre>
<pre><code>## [1] 91.9212</code></pre>
<pre class="r"><code>#check using mad
mad(chickwts$weight, median (chickwts$weight), constant = 1.4826)</code></pre>
<pre><code>## [1] 91.9212</code></pre>
<ol start="10" style="list-style-type: decimal">
<li>Using the data matrix , find the state with the minimum per capita income in the New England region as defined by the factor . Use the vector  to get the state name.</li>
</ol>
<pre class="r"><code>data(state.x77)</code></pre>
<pre><code>## Warning in data(state.x77): data set &#39;state.x77&#39; not found</code></pre>
<pre class="r"><code>#create df with state name, income, and division
state_df &lt;- data.frame(income=state.x77[,&quot;Income&quot;],
                    name=state.name,
                    div=state.division)
#Subset for New England
New_Eng &lt;- subset(state_df, div ==&quot;New England&quot;)

#State with min income per capita
New_Eng[which(New_Eng$income == min(New_Eng$income)), ]</code></pre>
<pre><code>##       income  name         div
## Maine   3694 Maine New England</code></pre>
<ol start="11" style="list-style-type: decimal">
<li>Use subscripting operations on the dataset  to find the vehicles with highway mileage of less than 25 miles per gallon (variable ) and weight (variable ) over 3500lbs. Print the model name, the price range (low, high), highway mileage, and the weight of the cars that satisfy these conditions.</li>
</ol>
<pre class="r"><code>data(Cars93, package= &quot;MASS&quot;)
df.cars93 &lt;- Cars93[Cars93$MPG.highway &lt; 25 &amp; Cars93$Weight &gt; 3500, c(&quot;Model&quot;, &quot;Price&quot;, &quot;MPG.highway&quot;, &quot;Weight&quot;)]
df.cars93[with(df.cars93, order(Price)), ]</code></pre>
<pre><code>##         Model Price MPG.highway Weight
## 16 Lumina_APV  16.3          23   3715
## 17      Astro  16.6          20   4025
## 26    Caravan  19.0          21   3705
## 56        MPV  19.1          24   3735
## 66      Quest  19.1          23   4100
## 70 Silhouette  19.5          23   3715
## 89    Eurovan  19.7          21   3960
## 36   Aerostar  19.9          20   3735
## 87     Previa  22.7          22   3785
## 28    Stealth  25.8          24   3805
## 63   Diamante  26.1          24   3730
## 49      ES300  28.0          24   3510
## 50      SC300  35.2          23   3515
## 48        Q45  47.9          22   4000</code></pre>
<ol start="12" style="list-style-type: decimal">
<li><p>Form a matrix object named  from the variables  from the  dataframe from the  package. Use it to create a list object named  containing named components as follows:</p>
<ol style="list-style-type: lower-alpha">
<li><p>A vector of means, named </p></li>
<li><p>A vector of standard errors of the means, named </p></li>
</ol></li>
</ol>
<pre class="r"><code>data(Cars93, package= &quot;MASS&quot;)
mycars &lt;- Cars93[,c(&quot;Min.Price&quot;, &quot;Max.Price&quot;, &quot;MPG.city&quot;, &quot;MPG.highway&quot;, &quot;EngineSize&quot;, &quot;Length&quot;, &quot;Weight&quot;)]
Cars.Means &lt;- sapply(mycars, mean)       
Cars.Means</code></pre>
<pre><code>##   Min.Price   Max.Price    MPG.city MPG.highway  EngineSize      Length 
##   17.125806   21.898925   22.365591   29.086022    2.667742  183.204301 
##      Weight 
## 3072.903226</code></pre>
<pre class="r"><code># function to calculate standard error &#39;standard.err&#39;
standard.err &lt;- function(x) sqrt(var(x)/length(x))
Cars.Std.Errors &lt;- lapply(mycars, standard.err)  
Cars.Std.Errors</code></pre>
<pre><code>## $Min.Price
## [1] 0.906921
## 
## $Max.Price
## [1] 1.143805
## 
## $MPG.city
## [1] 0.5827473
## 
## $MPG.highway
## [1] 0.5528742
## 
## $EngineSize
## [1] 0.1075695
## 
## $Length
## [1] 1.514196
## 
## $Weight
## [1] 61.16942</code></pre>
<ol start="13" style="list-style-type: decimal">
<li><p>Use the  function on the three-dimensional array  to compute:</p>
<ol style="list-style-type: lower-alpha">
<li>Sample means of the variables , for each of the three species </li>
</ol></li>
</ol>
<pre class="r"><code>apply(iris3, c(2,3), mean)</code></pre>
<pre><code>##          Setosa Versicolor Virginica
## Sepal L.  5.006      5.936     6.588
## Sepal W.  3.428      2.770     2.974
## Petal L.  1.462      4.260     5.552
## Petal W.  0.246      1.326     2.026</code></pre>
<pre><code>b) Sample means of the variables \textit{Sepal Length, Sepal Width, Petal Width} for the entire data set.</code></pre>
<pre class="r"><code>apply(iris3, 2, mean)</code></pre>
<pre><code>## Sepal L. Sepal W. Petal L. Petal W. 
## 5.843333 3.057333 3.758000 1.199333</code></pre>
<ol start="14" style="list-style-type: decimal">
<li><p>Use the data matrix  and the  function to obtain:</p>
<ol style="list-style-type: lower-alpha">
<li>The mean per capita income of the states in each of the four regions defined by the factor </li>
</ol></li>
</ol>
<pre class="r"><code>mydf &lt;- data.frame(state.x77, state.region = state.region, stringsAsFactors = FALSE)
tapply(mydf$Income, mydf$state.region, mean)</code></pre>
<pre><code>##     Northeast         South North Central          West 
##      4570.222      4011.938      4611.083      4702.615</code></pre>
<pre><code>b) The maximum illiteracy rates for states in each of the nine divisions defined by the factor \textit{state.division}</code></pre>
<pre class="r"><code>mydf &lt;- data.frame(state.x77, state.division = state.division, stringsAsFactors = FALSE)
tapply(mydf$Illiteracy, mydf$state.division, max)</code></pre>
<pre><code>##        New England    Middle Atlantic     South Atlantic 
##                1.3                1.4                2.3 
## East South Central West South Central East North Central 
##                2.4                2.8                0.9 
## West North Central           Mountain            Pacific 
##                0.8                2.2                1.9</code></pre>
<pre><code>c) The number of states in each region</code></pre>
<pre class="r"><code>mydf &lt;- data.frame(state.x77, state.region = state.region, state.name = state.name, stringsAsFactors = FALSE)
tapply(mydf$state.name, mydf$state.region, length)</code></pre>
<pre><code>##     Northeast         South North Central          West 
##             9            16            12            13</code></pre>
<ol start="15" style="list-style-type: decimal">
<li><p>Using the dataframe , produce a scatter plot matrix of the variables . Use different colors to identify cars belonging to each of the categories defined by the  variable in different colors.</p>
<pre class="r"><code>carsize = cut(mtcars[,&quot;wt&quot;], breaks=c(0, 2.5, 3.5, 5.5), 
labels = c(&quot;Compact&quot;,&quot;Midsize&quot;,&quot;Large&quot;))
carsize = cut(mtcars[,&quot;wt&quot;], breaks=c(0, 2.5, 3.5,
                                  5.5), labels = c(&quot;Compact&quot;,&quot;Midsize&quot;,&quot;Large&quot;))

mydf &lt;- data.frame(mtcars, carsize = carsize)

# Using base R
par(mfrow = c(1,1))
pairs(~mpg + disp + hp + drat + qsec, data=mydf, 
  main=&quot;mtcars Scatterplot Matrix&quot;)

# Using ggplot
library(ggplot2)
library(&#39;GGally&#39;)
ggpairs(mydf[,c(&quot;mpg&quot;, &quot;disp&quot;, &quot;hp&quot;, &quot;drat&quot;, &quot;qsec&quot;)])</code></pre></li>
<li><p>Use the function  to perform a one-way analysis of variance on the  data with  as the treatment factor. Assign the result to an object named  and use it to print an ANOVA table.</p></li>
</ol>
<pre class="r"><code>chick.aov &lt;- aov( weight ~ feed, chickwts)

# summary aov
summary.aov(chick.aov)</code></pre>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## feed         5 231129   46226   15.37 5.94e-10 ***
## Residuals   65 195556    3009                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># post-hoc test (Tukey HSD)
TukeyHSD(chick.aov)</code></pre>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = weight ~ feed, data = chickwts)
## 
## $feed
##                            diff         lwr       upr     p adj
## horsebean-casein    -163.383333 -232.346876 -94.41979 0.0000000
## linseed-casein      -104.833333 -170.587491 -39.07918 0.0002100
## meatmeal-casein      -46.674242 -113.906207  20.55772 0.3324584
## soybean-casein       -77.154762 -140.517054 -13.79247 0.0083653
## sunflower-casein       5.333333  -60.420825  71.08749 0.9998902
## linseed-horsebean     58.550000  -10.413543 127.51354 0.1413329
## meatmeal-horsebean   116.709091   46.335105 187.08308 0.0001062
## soybean-horsebean     86.228571   19.541684 152.91546 0.0042167
## sunflower-horsebean  168.716667   99.753124 237.68021 0.0000000
## meatmeal-linseed      58.159091   -9.072873 125.39106 0.1276965
## soybean-linseed       27.678571  -35.683721  91.04086 0.7932853
## sunflower-linseed    110.166667   44.412509 175.92082 0.0000884
## soybean-meatmeal     -30.480519  -95.375109  34.41407 0.7391356
## sunflower-meatmeal    52.007576  -15.224388 119.23954 0.2206962
## sunflower-soybean     82.488095   19.125803 145.85039 0.0038845</code></pre>
<ol start="17" style="list-style-type: decimal">
<li><p>Write an R function named  for conducting a one-sample t-test. Return a list object containing the two components:</p>
<ul>
<li><p>the t-statistic named T;</p></li>
<li><p>the two-sided p-value named P.</p></li>
</ul></li>
</ol>
<pre class="r"><code>#Annotated R Code
  library(HSAUR3)
  library(stats)
  attach(chickwts)
  head(chickwts)</code></pre>
<pre><code>##   weight      feed
## 1    179 horsebean
## 2    160 horsebean
## 3    136 horsebean
## 4    227 horsebean
## 5    217 horsebean
## 6    168 horsebean</code></pre>
<pre class="r"><code>  t.test(chickwts$weight,mu=240)</code></pre>
<pre><code>## 
##  One Sample t-test
## 
## data:  chickwts$weight
## t = 2.2999, df = 70, p-value = 0.02444
## alternative hypothesis: true mean is not equal to 240
## 95 percent confidence interval:
##  242.8301 279.7896
## sample estimates:
## mean of x 
##  261.3099</code></pre>
<pre class="r"><code>  ttest=function(x,mu,alpha){
    # x = data
    # mu = sample mean, 
    # alpha = alpha 
    # level = (1-confidence level)
    me=mean(x$weight)
    p1=qt(alpha/2,(nrow(x)-1))
    p2=qt(1-alpha/2,(nrow(x)-1))
    s=sqrt(var(x$weight))
    n=nrow(x)
    
    T=(me-mu)/(s/sqrt(nrow(x))) 
    P=seq(1,1,1)
    P[1]=2*(1-pt(T,n))
    P=data.frame(P)
    return (cbind(P,T))
  }
  
  t_test_values &lt;- ttest(chickwts,240,0.05)
  print (&quot;T value and two sided P values returned by the funtion: &quot;)</code></pre>
<pre><code>## [1] &quot;T value and two sided P values returned by the funtion: &quot;</code></pre>
<pre class="r"><code>  print(t_test_values)</code></pre>
<pre><code>##            P        T
## 1 0.02439824 2.299879</code></pre>
<p>Use this function to test the hypothesis that the mean of the  variable (in the  dataset) is equal to 240 against the two-sided alternative. </p>
<pre class="r"><code>  message(&quot;Hypothesis Result:&quot;)</code></pre>
<pre><code>## Hypothesis Result:</code></pre>
<pre class="r"><code>  if (2*abs(t_test_values[1,2])&gt;2*abs(t_test_values[1,1])){
    print(&quot;Rejected! The true mean is NOT 240 !!&quot;)
  } else if (2*abs(t_test_values[1,2])&lt;2*abs(t_test_values[1,1])){
    print(&quot;Null. The mean is 240 !!&quot;)
  }</code></pre>
<pre><code>## [1] &quot;Rejected! The true mean is NOT 240 !!&quot;</code></pre>

    </div>

    


    

<div class="article-tags">
  
  <a class="badge badge-light" href="/achalneupane.github.io/tags/r/">R</a>
  
  <a class="badge badge-light" href="/achalneupane.github.io/tags/statistics/">Statistics</a>
  
  <a class="badge badge-light" href="/achalneupane.github.io/tags/modern-applied-statistics-i/">Modern Applied Statistics I</a>
  
</div>



    
      








  
  
    
  
  





  
  
  
  
  <div class="media author-card" itemscope itemtype="http://schema.org/Person">
    

    <div class="media-body">
      <h5 class="card-title" itemprop="name"><a href="/achalneupane.github.io/authors/achal-neupane/"></a></h5>
      
      
      <ul class="network-icon" aria-hidden="true">
        
      </ul>
    </div>
  </div>



      
      
      <div class="article-widget">
        <div class="hr-light"></div>
        <h3>Related</h3>
        <ul>
          
          <li><a href="/achalneupane.github.io/post/density_estimation/">Density Estimation</a></li>
          
          <li><a href="/achalneupane.github.io/post/logistic_regression_glm_i/">Logistic Regression&amp;GLM-I</a></li>
          
          <li><a href="/achalneupane.github.io/post/logistic_regression_glm_ii/">Logistic Regression&amp;GLM-II</a></li>
          
          <li><a href="/achalneupane.github.io/post/final_assignment/">Final assignment</a></li>
          
          <li><a href="/achalneupane.github.io/post/midterm_project/">Midterm data analysis</a></li>
          
        </ul>
      </div>
      
    

    

    


  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
      

      
      
    

    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/achalneupane.github.io/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/achalneupane.github.io/js/academic.min.16bbb3750feb7244c9bc409a5a4fe678.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/achalneupane.github.io/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/achalneupane.github.io/terms/">Terms</a>
        
  </p>
  

  <p class="powered-by">
    &copy; 2019 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
